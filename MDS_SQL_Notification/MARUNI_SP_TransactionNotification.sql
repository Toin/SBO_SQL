USE [MARUNI_20110621]
GO
/****** Object:  StoredProcedure [dbo].[SBO_SP_TransactionNotification]    Script Date: 06/28/2011 16:53:06 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER proc [dbo].[SBO_SP_TransactionNotification] 

@object_type nvarchar(20), 				-- SBO Object Type
@transaction_type nchar(1),			-- [A]dd, [U]pdate, [D]elete, [C]ancel, C[L]ose
@num_of_cols_in_key int,
@list_of_key_cols_tab_del nvarchar(255),
@list_of_cols_val_tab_del nvarchar(255)

AS
begin

-- Return values
declare @error  int				-- Result (0 for no error)
declare @error_message nvarchar (200) 		-- Error string to be displayed
select @error = 0
select @error_message = N'Ok'

--------------------------------------------------------------------------------------------------------------------------------

--	ADD	YOUR	CODE	HERE

--------------------------------------------------------------------------------------------------------------------------------

-- 20100423 by Toin
-- Sales order Validation Object type = 17
-- IF Column U_MIS_JenisKaca OR U_MIS_JNSKACATEB 
-- OR U_MIS_Tebal Or U_MIS_Warna OR U_MIS_Desc = Kosong


declare 
@BaseType INT,
@DocNum INT,
@DocEntry INT,
@LineNum INT,
@VisOrder INT,
@WhsCode NVARCHAR(8),
@ItemCode NVARCHAR(20),
@Quantity Numeric(19,6),
@Price Numeric(19,6),
@KodeJenisKaca NVARCHAR(10),
@JenisKaca NVARCHAR(20),
@Tebal INT,
@Warna NVARCHAR(2),
@Keterangan NVARCHAR(40),
@LUASM2 Numeric(19,6),
@PriceM2 Numeric(19,6),
@QtyLbr INT,
@TotalRM Numeric(19,6),
@Job01 NVARCHAR(40), @JobQty01 Numeric(19,6), @JobRp01 Numeric(19,6), @TotalJob01 Numeric(19,6),
@Job02 NVARCHAR(40), @JobQty02 Numeric(19,6), @JobRp02 Numeric(19,6), @TotalJob02 Numeric(19,6),
@Job03 NVARCHAR(40), @JobQty03 Numeric(19,6), @JobRp03 Numeric(19,6), @TotalJob03 Numeric(19,6),
@Job04 NVARCHAR(40), @JobQty04 Numeric(19,6), @JobRp04 Numeric(19,6), @TotalJob04 Numeric(19,6),
@Job05 NVARCHAR(40), @JobQty05 Numeric(19,6), @JobRp05 Numeric(19,6), @TotalJob05 Numeric(19,6),
@Job06 NVARCHAR(40), @JobQty06 Numeric(19,6), @JobRp06 Numeric(19,6), @TotalJob06 Numeric(19,6),
@Job07 NVARCHAR(40), @JobQty07 Numeric(19,6), @JobRp07 Numeric(19,6), @TotalJob07 Numeric(19,6),
@TotalCalJob01 Numeric(19,6),
@TotalCalJob02 Numeric(19,6),
@TotalCalJob03 Numeric(19,6),
@TotalCalJob04 Numeric(19,6),
@TotalCalJob05 Numeric(19,6),
@TotalCalJob06 Numeric(19,6),
@TotalCalJob07 Numeric(19,6),
@TotalCalRM Numeric(19,6),
@TotalALLRM Numeric(19,6),
@DocType NVARCHAR(5),
@countRecord INT



 
--Write the below code i.e Block Issue of material PdO generated by SO Marketing. ItemCode = XDUMMY

IF @transaction_type = 'A' AND @Object_type = '60'

BEGIN

IF EXISTS (SELECT T0.DOCENTRY FROM dbo.IGE1 T0 WHERE T0.DOCENTRY = @list_of_cols_val_tab_del)

BEGIN

	DECLARE @entryGI INT

	SELECT @entryGI = T0.BASEENTRY FROM dbo.IGE1 T0 WHERE T0.DOCENTRY = @list_of_cols_val_tab_del

	IF EXISTS (
		SELECT T1.ITEMCODE, T1.PLANNEDQTY, T2.QUANTITY, T2.BASEENTRY 
		FROM dbo.OWOR T0 
		INNER JOIN dbo.WOR1 T1 ON T0.DOCENTRY = T1.DOCENTRY 
		LEFT OUTER JOIN dbo.IGE1 T2 
			ON T2.BASEENTRY = T0.DOCENTRY AND T1.ITEMCODE = T2.ITEMCODE
		WHERE T0.DOCENTRY = @entryGI
			AND T1.ItemCode = 'XDUMMY'
		)
		BEGIN
			SELECT @Error = 1, @error_message = 'PdO Generated Components cannot be Issued! Item XDUMMY Tidak boleh melakukan Issue Material for PdO!'
		END
END
END


--Write the below code i.e Block Receipt FG from PdO generated by SO Marketing. ItemCode = XDUMMY

IF @transaction_type = 'A' AND @Object_type = '59'

BEGIN

IF EXISTS (SELECT T0.DOCENTRY FROM dbo.IGN1 T0 WHERE T0.DOCENTRY = @list_of_cols_val_tab_del)

BEGIN

	DECLARE @blockReceiptfromPdo_PdODocEntry INT = 0,
			@blockReceiptfromPdo_PdODocnum INT = 0,
			@qtyFGRcpt_input numeric(19, 6)

	SELECT @blockReceiptfromPdo_PdODocEntry = T0.BASEENTRY, 
			@blockReceiptfromPdo_PdODocnum = T0.BaseRef,
			@qtyFGRcpt_input = T0.Quantity 
			FROM dbo.IGN1 T0 WHERE T0.DOCENTRY = @list_of_cols_val_tab_del

	-- Validation Rule: XDUMMY Component not allowed to do Issue for PdO and Receipt from PdO
	IF EXISTS (
		SELECT T1.ITEMCODE, T1.PLANNEDQTY, T2.QUANTITY, T2.BASEENTRY 
		FROM dbo.OWOR T0 
		INNER JOIN dbo.WOR1 T1 ON T0.DOCENTRY = T1.DOCENTRY 
		LEFT OUTER JOIN dbo.IGE1 T2 
			ON T2.BASEENTRY = T0.DOCENTRY AND T1.ITEMCODE = T2.ITEMCODE
		WHERE T0.DOCENTRY = @blockReceiptfromPdo_PdODocEntry
			AND T1.ItemCode = 'XDUMMY'
		)
		BEGIN
			SELECT @Error = 1, @error_message = 'PdO Generated, Item XDUMMY Tidak boleh melakukan Issue Material for PdO dan Receipt FG!'
		END
	ELSE	
		-- Validation Rule: Total Receipt FG must be <= PdO FG PlannedQty
		DECLARE @PDO_FG_PLANNEDQTY NUMERIC(19, 6) = 0,
				@PDO_COMPLETEQTY NUMERIC(19, 6) = 0,
				@IGN1_PDONUM INT = 0,
				@IGN1_LINE INT = 0,
				@IGN1_ITEMCODE NVARCHAR(20)

			SELECT @IGN1_PDONUM = T1.DocNum, @PDO_FG_PLANNEDQTY = T1.PlannedQty, @IGN1_LINE = T0.VisOrder + 1,
				@IGN1_ITEMCODE = T0.ItemCode, @PDO_COMPLETEQTY = T1.CmpltQty, @qtyFGRcpt_input = T0.Quantity 
			FROM dbo.IGN1 T0 -- Receipt from PdO
			LEFT OUTER JOIN dbo.OWOR T1 
				ON T0.BaseEntry = T1.DocEntry AND T0.ItemCode = T1.ItemCode
			WHERE T0.DOCENTRY = @list_of_cols_val_tab_del -- 7749
				AND T1.ItemCode NOT LIKE 'X%'
				AND T0.Quantity > T1.PlannedQty - (T1.CmpltQty - T0.Quantity)
			--GROUP BY T1.DocNum, T0.VisOrder, T1.PlannedQty, T0.ItemCode
			--HAVING SUM(T0.Quantity) > T1.PlannedQty
		
		IF EXISTS(
			SELECT T1.DocNum, T1.PlannedQty, T0.ItemCode --, SUM(T0.QUANTITY) 
			FROM dbo.IGN1 T0 -- Receipt from PdO
			LEFT OUTER JOIN dbo.OWOR T1 
				ON T0.BaseEntry = T1.DocEntry AND T0.ItemCode = T1.ItemCode
			WHERE T0.DOCENTRY = @list_of_cols_val_tab_del -- 7749
				AND T1.ItemCode NOT LIKE 'X%'
				AND T0.Quantity > T1.PlannedQty - (T1.CmpltQty - T0.Quantity)
			--GROUP BY T1.DocNum, T0.VisOrder, T1.PlannedQty, T0.ItemCode
			--HAVING SUM(T0.Quantity) > T1.PlannedQty
		)
		BEGIN
			SELECT @Error = 1, @error_message = 'LINE: ' + CONVERT(NVARCHAR, ISNULL(@IGN1_LINE, 0)) 
				+ ' PDO#: ' + CONVERT(NVARCHAR, ISNULL(@IGN1_PDONUM, 0)) 
				+ ' PDO Planned Qty: ' + CONVERT(NVARCHAR, ISNULL(@PDO_FG_PLANNEDQTY, 0))
				+ ' Total Receipt Qty: ' + CONVERT(NVARCHAR, ISNULL(@PDO_COMPLETEQTY, 0) - ISNULL(@qtyFGRcpt_input, 0))
				+ ' Receipt Qty Input: ' + CONVERT(NVARCHAR, ISNULL(@qtyFGRcpt_input, 0))
				+ ' Available Qty: ' + 
					CONVERT(NVARCHAR, (ISNULL(@PDO_FG_PLANNEDQTY, 0) - ISNULL(@PDO_COMPLETEQTY, 0) - ISNULL(@qtyFGRcpt_input, 0)))
				+ ' Receipt FG Qty telah melebihi Total PdO Planned Qty!'
		END
		--ELSE
		
		--BEGIN
		--	select @error = 0, @error_message = 'else ok'
		--END
		
	--GOTO Jump_EndNotif;
	--GOTO Jump_EndNotif;
	 		
END -- end if exist doc GR
END -- end if block GR type


----Write the below code i.e Block receipt of material without issuing component items.
 
--IF @transaction_type = 'A' AND @Object_type = '59'

--BEGIN

--IF EXISTS (SELECT T0.DOCENTRY FROM dbo.IGN1 T0 WHERE T0.DOCENTRY = @list_of_cols_val_tab_del)

--BEGIN

--	DECLARE @blockReceiptfromPdo_PdODocEntry INT = 0,
--			@qtyFGRcpt_input NUMERIC(19, 6) = 0

--	SELECT @blockReceiptfromPdo_PdODocEntry = T0.BASEENTRY, @qtyFGRcpt_input = Quantity FROM dbo.IGN1 T0 WHERE T0.DOCENTRY = @list_of_cols_val_tab_del


----DECLARE @entry INT = 0
----select @entry
----SELECT @entry = T0.BASEENTRY FROM dbo.IGN1 T0 WHERE T0.DOCENTRY = 18181818181
----if @entry is null 
----select @entry = 8
----else
----select @entry =2


----select @entry

--	IF @blockReceiptfromPdo_PdODocEntry <> 0 --and @blockReceiptfromPdo_PdODocEntry is not null 
--			--if @entry = 0
--			--begin
--			--				select @error = 1
--			--			select @error_message = N'Ok belum ada issue'

--			--end
--			--else
	
--	Begin
	
--	--IF EXISTS (
--	--	-- FIXING BY TOIN 2011-02-09 SUMMARIZE ALL COMPONENT ISSUED QTY
--	--	SELECT T1.ITEMCODE, T1.PLANNEDQTY, SUM(T2.QUANTITY), T2.BASEENTRY AS ISSUEDQTY
--	--	FROM dbo.OWOR T0 
--	--	INNER JOIN dbo.WOR1 T1 ON T0.DOCENTRY = T1.DOCENTRY 
--	--	LEFT OUTER JOIN dbo.IGE1 T2 
--	--		ON T2.BASEENTRY = T0.DOCENTRY AND T1.ITEMCODE = T2.ITEMCODE
--	--	WHERE T0.DOCENTRY = @entry 
--	--		AND T1.ItemCode NOT LIKE 'X%'
--	--	GROUP BY T1.ITEMCODE, T1.PLANNEDQTY, T2.BASEENTRY
--	--	HAVING T1.PLANNEDQTY > SUM(ISNULL(T2.QUANTITY, 0)) 
		 	
--	--	)

--	--SELECT @Error = 1, @error_message = 'Components NOT ISSUED'

--	--END


--	declare @ITEMCODE_COMPONENT nvarchar(20),
--			@PLANNEDQTY_FG numeric(19, 6) = 0,
--			@PLANNEDQTY_Component numeric(19, 6) = 0,
--			@CmpltQty_FG numeric(19, 6) = 0,
--			--@qtyFGRcpt_input numeric(19, 6),
--			@TotalIssued_ComponentQty numeric(19, 6) = 0,
--			@Total_ygBisaDiRcpt_FGQty_dimanaComponentSudahIssued numeric(19, 6) = 0,
--			@Total_ygBisaDiRcpt_ComponentQty_dimanaComponentSudahIssued numeric(19, 6) = 0,
--			@Total_Rcpt_FG_ComponentQty numeric(19, 6) = 0,
--			@PdO# int = 0,
--			@PdONum int = 0,
--			@DecPoint_Rounding smallint

			
--	select @DecPoint_Rounding = 4 --, @qtyFGRcpt_input = 107.4228, @DecPoint_Rounding = 4 -- 1207.422785

--	--select @ITEMCODE_COMPONENT ITEMCODE, @PLANNEDQTY_FG PLANNEDQTY_FGPlannedQty, @PLANNEDQTY_Component PLANNEDQTY_ComponentPlannedQty, 
--	--		@CmpltQty_FG CompletedQtyFG, @Total_Rcpt_FG_ComponentQty Total_Rcpt_FG_ComponentQty, 
--	--		@qtyFGRcpt_input qtyFGRcpt_input, 
--	--		@TotalIssued_ComponentQty TotalIssued_ComponentQty, 
--	--		@Total_ygBisaDiRcpt_ComponentQty_dimanaComponentSudahIssued Total_ygBisaDiRcpt_ComponentQty_dimanaComponentSudahIssued,
--	--		@Total_ygBisaDiRcpt_FGQty_dimanaComponentSudahIssued Total_ygBisaDiRcpt_FGqty_dimanaComponentSudahIssued,
--	--		@PdO# PdO#

--		SELECT @ITEMCODE = T1.ITEMCODE, @PLANNEDQTY_FG = T0.PlannedQty, @PLANNEDQTY_Component = T1.PLANNEDQTY , --1300 * T1.BaseQty,
--			@CmpltQty_FG = (T0.CmpltQty - @qtyFGRcpt_input) -- CompletedQtyFG
--			,
--			@TotalIssued_ComponentQty = SUM(T2.QUANTITY) --TotalIssued_ComponentQty, 
--			,
--			@Total_ygBisaDiRcpt_ComponentQty_dimanaComponentSudahIssued = (SUM(T2.QUANTITY) - 
--				isnull((
--				select (SUM(T3.QUANTITY) - @qtyFGRcpt_input) -- / T0.PlannedQty * T1.PlannedQty Total_Rcpt_qty
--				FROM dbo.OWOR T0 
--				INNER JOIN dbo.WOR1 T1 ON T0.DOCENTRY = T1.DOCENTRY 
--				LEFT OUTER JOIN dbo.IGN1 T3 -- Receipt from PdO
--					ON T3.BASEENTRY = T0.DOCENTRY AND T0.ITEMCODE = T3.ITEMCODE
--				WHERE T0.DOCENTRY = @blockReceiptfromPdo_PdODocEntry -- 7749
--					AND T1.ItemCode NOT LIKE 'X%'
--				--GROUP BY T0.PlannedQty, T1.PlannedQty
--				), 0) / T0.PlannedQty * T1.PlannedQty 
--			) --Total_ygBisaDiRcpt_ComponentQty_dimanaComponentSudahIssued,
--			,
--			@Total_ygBisaDiRcpt_FGqty_dimanaComponentSudahIssued = 
--			ROUND(
--				(SUM(T2.QUANTITY) - 
--					(( 
--					select (ISNULL(SUM(T3.QUANTITY), 0) ) -- - @qtyFGRcpt_input ) --/ T0.PlannedQty * T1.PlannedQty Total_Rcpt_qty
--					FROM dbo.OWOR T0 
--					INNER JOIN dbo.WOR1 T1 ON T0.DOCENTRY = T1.DOCENTRY 
--					LEFT OUTER JOIN dbo.IGN1 T3 -- Receipt from PdO
--						ON T3.BASEENTRY = T0.DOCENTRY AND T0.ITEMCODE = T3.ITEMCODE 
--					WHERE T0.DOCENTRY = @blockReceiptfromPdo_PdODocEntry -- 7749
--						AND T1.ItemCode NOT LIKE 'X%'
--					--GROUP BY T0.PlannedQty, T1.PlannedQty
--					) / T0.PlannedQty * T1.PlannedQty)  --/ T0.PlannedQty * T1.PlannedQty) 
--				--) / T1.BaseQty
--				) / T1.PlannedQty * T0.PlannedQty
--					+ @qtyFGRcpt_input 
--				, @DecPoint_Rounding)  --Total_ygBisaDiRcpt_FGqty_dimanaComponentSudahIssued,
--				--, 4)  --Total_ygBisaDiRcpt_FGqty_dimanaComponentSudahIssued,
--			,
--			@Total_Rcpt_FG_ComponentQty = 
--			ROUND(
--				(
--				select (SUM(T3.QUANTITY) - @qtyFGRcpt_input) --/ T0.PlannedQty * T1.PlannedQty Total_Rcpt_qty
--				FROM dbo.OWOR T0 
--				INNER JOIN dbo.WOR1 T1 ON T0.DOCENTRY = T1.DOCENTRY 
--				LEFT OUTER JOIN dbo.IGN1 T3 -- Receipt from PdO
--					ON T3.BASEENTRY = T0.DOCENTRY AND T0.ITEMCODE = T3.ITEMCODE 
--				WHERE T0.DOCENTRY = @blockReceiptfromPdo_PdODocEntry -- 7749
--					AND T1.ItemCode NOT LIKE 'X%'
--				--GROUP BY T0.PlannedQty, T1.PlannedQty
--				) / T0.PlannedQty * T1.PlannedQty 
--				, @DecPoint_Rounding) --Total_Rcpt_FG_ComponentQty
--				--, 4) --Total_Rcpt_FG_ComponentQty
--			,
--			@PdO# = T2.BASEENTRY, -- AS PdO#
--			@PdONum = T0.DocNum	
--			FROM dbo.OWOR T0 
--			INNER JOIN dbo.WOR1 T1 ON T0.DOCENTRY = T1.DOCENTRY 
--			LEFT OUTER JOIN dbo.IGE1 T2 -- Issued from PdO
--				ON T2.BASEENTRY = T0.DOCENTRY AND T1.ITEMCODE = T2.ITEMCODE --AND T2.BaseLine = T1.LineNum
--			WHERE T0.DOCENTRY = @blockReceiptfromPdo_PdODocEntry -- 7749
--				AND T1.ItemCode NOT LIKE 'X%'
--			GROUP BY T1.ITEMCODE, T0.PlannedQty, T1.PLANNEDQTY, T0.CmpltQty, T2.BASEENTRY, T0.DocNum, T1.BaseQty
			
--			-- receipt FG harus < dari yg bisa di receipt dimana component2 nya sudah issued.
--			--HAVING 
--			--ROUND(
--			--(SUM(T2.QUANTITY) - 
--			--	(
--			--	select SUM(T3.QUANTITY) / T0.PlannedQty * T1.PlannedQty Total_Rcpt_qty
--			--	FROM dbo.OWOR T0 
--			--	INNER JOIN dbo.WOR1 T1 ON T0.DOCENTRY = T1.DOCENTRY 
--			--	LEFT OUTER JOIN dbo.IGN1 T3 -- Receipt from PdO
--			--		ON T3.BASEENTRY = T0.DOCENTRY AND T0.ITEMCODE = T3.ITEMCODE
--			--	WHERE T0.DOCENTRY = @blockReceiptfromPdo_PdODocEntry -- 7749
--			--		AND T1.ItemCode NOT LIKE 'X%'
--			--	GROUP BY T0.PlannedQty, T1.PlannedQty
--			--	)
--			--) / T1.BaseQty
--			--, @DecPoint_Rounding)  --Total_ygBisaDiRcpt_qty_dimanaComponentSudahIssued,
--			----, 4)  --Total_ygBisaDiRcpt_qty_dimanaComponentSudahIssued,
--			-->= @qtyFGRcpt_input -- 1300 --* T1.BaseQty
				

--			if (@qtyFGRcpt_input > ( ROUND(ISNULL(@PLANNEDQTY_FG, 0), @DecPoint_Rounding)
--			- ROUND(ISNULL(@CmpltQty_FG, 0), @DecPoint_Rounding)) - @qtyFGRcpt_input) or
--			 @qtyFGRcpt_input > isnull(@Total_ygBisaDiRcpt_FGqty_dimanaComponentSudahIssued, 0) --> 0 
--	--		begin

--	--			--Select @Error = 1, @error_message = 'Bisa Receipt FG'

--	--		SELECT @Error = 1, @error_message = 'bisa rcpt FG! Total FG PlannedQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@PLANNEDQTY_FG, 0), @DecPoint_Rounding)) +
--	--				--' Total FG Component PlannedQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@PLANNEDQTY_Component, 0), @DecPoint_Rounding)) +
--	--				' Receipt FGQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@CmpltQty_FG, 0), @DecPoint_Rounding)) +
--	--				--' Receipt FGComponentQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@Total_Rcpt_FG_ComponentQty, 0), @DecPoint_Rounding)) +
--	--				' Issued Component Qty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@TotalIssued_ComponentQty, 0), @DecPoint_Rounding)) +
--	--				--' Receipt FG Qty yang akan diinput: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@qtyFGRcpt_input, 0), @DecPoint_Rounding)) +
--	--				' yg Bisa DiRcpt_FGQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@Total_ygBisaDiRcpt_FGQty_dimanaComponentSudahIssued, 0), @DecPoint_Rounding)) +
--	--				--' yg Bisa DiRcpt_FGQty dimanaComponentSudahIssued: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@Total_ygBisaDiRcpt_FGQty_dimanaComponentSudahIssued, 0), @DecPoint_Rounding))
--	--				' yg Bisa DiRcpt_CmpQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@Total_ygBisaDiRcpt_ComponentQty_dimanaComponentSudahIssued, 0), @DecPoint_Rounding))

--	---- catatan: sewaktu ambil data completedqty FG harus kurangin dgn rcpt qty yg sedang diinput/akan di add receipt fg
	
--	----select @CmpltQty_FG = CmpltQty - @qtyFGRcpt_input from OWOR where DocNum = 1011003531


--	--		end
--	--		else
--			begin
--			SELECT @Error = 1, @error_message = ' pdo#: ' + CONVERT(NVARCHAR(20), @PdONum) + '; Tidak bisa Rcpt FG! Total FG PlannedQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@PLANNEDQTY_FG, 0), @DecPoint_Rounding)) +
--			--' pdo#: ' + CONVERT(NVARCHAR(20), @blockReceiptfromPdo_PdODocEntry) +
--				--'Total FG PlannedQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@PLANNEDQTY_FG, 0), @DecPoint_Rounding)) +
--					--' Total FG Component PlannedQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@PLANNEDQTY_Component, 0), @DecPoint_Rounding)) +
--					--' Sudah Rcpt FG Qty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@CmpltQty_FG, 0), @DecPoint_Rounding)) +
--					--' Sudah Rcpt FG ComponentQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@Total_Rcpt_FG_ComponentQty, 0), @DecPoint_Rounding)) +
--					--' Sudah Issued ComponentQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@TotalIssued_ComponentQty, 0), @DecPoint_Rounding)) +
--					--' Receipt FG Qty yg diinput: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@qtyFGRcpt_input, 0), @DecPoint_Rounding)) +
--					--' Total yg Bisa DiRcpt_FGQty dimanaComponentSudahIssued: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@Total_ygBisaDiRcpt_FGQty_dimanaComponentSudahIssued, 0), @DecPoint_Rounding)) +
--					--' Total yg Bisa DiRcpt_ComponentQty dimanaComponentSudahIssued: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@Total_ygBisaDiRcpt_ComponentQty_dimanaComponentSudahIssued, 0), @DecPoint_Rounding))
--					--' Total FG Component PlannedQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@PLANNEDQTY_Component, 0), @DecPoint_Rounding)) +
--					' Receipt FGQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@CmpltQty_FG, 0), @DecPoint_Rounding)) +
--					--' Receipt FGComponentQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@Total_Rcpt_FG_ComponentQty, 0), @DecPoint_Rounding)) +
--					' Issued Component Qty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@TotalIssued_ComponentQty, 0), @DecPoint_Rounding)) +
--					--' Receipt FG Qty yang akan diinput: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@qtyFGRcpt_input, 0), @DecPoint_Rounding)) +
--					' Bisa DiRcpt_FGQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@Total_ygBisaDiRcpt_FGQty_dimanaComponentSudahIssued, 0), @DecPoint_Rounding)) +
--					--' yg Bisa DiRcpt_FGQty dimanaComponentSudahIssued: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@Total_ygBisaDiRcpt_FGQty_dimanaComponentSudahIssued, 0), @DecPoint_Rounding))
--					' Bisa DiRcpt_CmpQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@Total_ygBisaDiRcpt_ComponentQty_dimanaComponentSudahIssued, 0), @DecPoint_Rounding)) +
--					' Inp FG: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@qtyFGRcpt_input, 0), @DecPoint_Rounding))

--			--SELECT @Error = 1, @error_message = 'Tidak bisa receipt FG! ' +
--			--		'Total FG PlannedQty: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@PLANNEDQTY_FG, 0), @DecPoint_Rounding) ) 
--			end
--			else
--			begin
--				--select 'bisa rcpt FG'	
--				select @error = 1 
--				select @error_message = N'Ok! ' +
--				' plannFG: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@PLANNEDQTY_FG, 0), @DecPoint_Rounding)) + 
--				' Completed FG: ' + CONVERT(NVARCHAR(20), ROUND(ISNULL(@CmpltQty_FG, 0), @DecPoint_Rounding)) + 
--				' fg ' + CONVERT(NVARCHAR(20), isnull(@qtyFGRcpt_input, 0)) + 
--				' FG inpt: ' + CONVERT(NVARCHAR(20), isnull(@qtyFGRcpt_input, 0)) + 
--				' Total bisa FG: ' + CONVERT(NVARCHAR(20), ISNULL(@Total_ygBisaDiRcpt_FGQty_dimanaComponentSudahIssued, 0) )
--			end

--	end -- end if Rcpt from PdO
	
----SELECT 'BRAPA: ' + CONVERT(NVARCHAR, ROUND( 50.123465, 4)), ROUND( 50.123465, 4) 
--				--select @error = 1
--				--select @error_message = N'Ok'
--End 

----ELSE
------SELECT @Error = 1, @error_message = 'Components NOT ISSUED?'

----		SELECT @Error = 1, @error_message = 'Tidak bisa receipt FG! ???' --+ @Object_type 
----		--+ CONVERT(NVARCHAR, @list_of_cols_val_tab_del )
--				--select @error = 1
--				--select @error_message = N'Ok'
--END



-- BLOCKING Delivery ORDER
IF  (@object_type = N'15')
AND (@transaction_type = 'A' OR @transaction_type = 'U')
BEGIN -- OBJECT TYPE

--SET @countRecord = 0
--	SELECT TOP 1 @countRecord = 1,
--		@WhsCode = WhsCode, @ItemCode = ItemCode
--		FROM DLN1 T1
--		JOIN ODLN T0
--		ON T1.DOCENTRY = T0.DOCENTRY
--		WHERE T1.DOCENTRY = CAST(@list_of_cols_val_tab_del AS INT)
--			AND DOCTYPE = 'I'	
--
--IF @CountRecord > 0
--BEGIN
----------------------------------------------------------------------------------------------------------------
--  AWAL --- JIKA Warehouse FG-001 Dengan kondisi Penjualan Kaca Dan Jasa, ItemCode Tidak Diawali dengan CS ---
----------------------------------------------------------------------------------------------------------------
--	IF @WhsCode = 'FG-001' AND @ItemCode NOT LIKE 'CS%'
--	BEGIN -- WAREHOUSE AND ITEM
		SET @countRecord = 0
		select TOP 1
		@VisOrder = VisOrder,
		@LineNum = LineNum,
		@WhsCode = WhsCode,
		@ItemCode = ItemCode,
		@Quantity = Quantity,
		@Price = ROUND(Price,0),
		@KodeJenisKaca = U_MIS_JNSKACATEB,
		@JenisKaca = U_MIS_JenisKaca,
		@Tebal = U_MIS_Tebal,
		@Warna = U_MIS_Warna,
		@Keterangan = U_MIS_Desc,		
		@LUASM2 = U_SO_LUASM2,
		@PriceM2 = U_SO_PrcM2,
		@QtyLbr = U_MIS_QtyLbr,
		@TotalRM = ROUND(U_SO_TRM,2),
		@TotalCalRM = ROUND(Round(U_SO_LUASM2,4) * ROUND(U_SO_PrcM2,4),2),
		@TotalCalJob01 = ROUND(ROUND(U_SO_QP1,4) * ROUND(U_SO_P1Prc,4),4),
		@TotalCalJob02 = ROUND(ROUND(U_SO_QP2,4) * ROUND(U_SO_P2Prc,4),4),
		@TotalCalJob03 = ROUND(ROUND(U_SO_QP3,4) * ROUND(U_SO_P3Prc,4),4),
		@TotalCalJob04 = ROUND(ROUND(U_SO_QP4,4) * ROUND(U_SO_P4Prc,4),4),
		@TotalCalJob05 = ROUND(ROUND(U_SO_QP5,4) * ROUND(U_SO_P5Prc,4),4),
		@TotalCalJob06 = ROUND(ROUND(U_SO_QP6,4) * ROUND(U_SO_P6Prc,4),4),
		@TotalCalJob07 = ROUND(ROUND(U_SO_QP7,4) * ROUND(U_SO_P7Prc,4),4),		
		@TotalALLRM = Round(T1.U_SO_TRM + T1.U_SO_TP1 + T1.U_SO_TP2 + T1.U_SO_TP3 + T1.U_SO_TP4 + T1.U_SO_TP5 + T1.U_SO_TP6 + T1.U_SO_TP7,0),
		@Job01 = U_SO_P1, @JobQty01 = U_SO_QP1, @JobRp01 = U_SO_P1Prc, @TotalJob01 = ROUND(U_SO_TP1,4),
		@Job02 = U_SO_P2, @JobQty02 = U_SO_QP2, @JobRp02 = U_SO_P2Prc, @TotalJob02 = ROUND(U_SO_TP2,4),
		@Job03 = U_SO_P3, @JobQty03 = U_SO_QP3, @JobRp03 = U_SO_P3Prc, @TotalJob03 = ROUND(U_SO_TP3,4),
		@Job04 = U_SO_P4, @JobQty04 = U_SO_QP4, @JobRp04 = U_SO_P4Prc, @TotalJob04 = ROUND(U_SO_TP4,4),
		@Job05 = U_SO_P5, @JobQty05 = U_SO_QP5, @JobRp05 = U_SO_P5Prc, @TotalJob05 = ROUND(U_SO_TP5,4),
		@Job06 = U_SO_P6, @JobQty06 = U_SO_QP6, @JobRp06 = U_SO_P6Prc, @TotalJob06 = ROUND(U_SO_TP6,4),
		@Job07 = U_SO_P7, @JobQty07 = U_SO_QP7, @JobRp07 = U_SO_P7Prc, @TotalJob07 = ROUND(U_SO_TP7,4),
		@countRecord = 1
		FROM DLN1 T1
		JOIN ODLN T0
		ON T1.DOCENTRY = T0.DOCENTRY
		WHERE T1.DOCENTRY = CAST(@list_of_cols_val_tab_del AS INT)
			AND DOCTYPE = 'I'
			AND WhsCode = 'FG-001' AND ItemCode NOT Like 'CS%'
			AND 
			(	
			(T1.Quantity IS NULL OR T1.Quantity = 0)
--			OR (T1.Price IS NULL OR T1.Price = 0)
			OR (T1.U_MIS_JNSKACATEB IS NULL OR T1.U_MIS_JNSKACATEB = '')
			OR (T1.U_MIS_JenisKaca IS NULL OR T1.U_MIS_JenisKaca= '')
			OR (T1.U_MIS_Tebal IS NULL OR T1.U_MIS_Tebal= 0)
			OR (T1.U_MIS_Warna IS NULL OR T1.U_MIS_Warna= '')
			OR (T1.U_MIS_Desc IS NULL OR T1.U_MIS_Desc= '')
			OR (T1.U_SO_LUASM2 IS NULL OR T1.U_SO_LUASM2 = 0)
--			OR (T1.U_SO_PrcM2 IS NULL OR T1.U_SO_PrcM2 = 0)
--			OR (T1.U_SO_TRM IS NULL OR T1.U_SO_TRM = 0)
-- Diround jadi 0 karena ada penjualan yang berdasarkan lembar
--OR (Round(T1.PRICE,2) <> Round(T1.U_SO_TRM + T1.U_SO_TP1 + T1.U_SO_TP2 + T1.U_SO_TP3 + T1.U_SO_TP4 + T1.U_SO_TP5 + T1.U_SO_TP6 + T1.U_SO_TP7,2))
			--OR (Round(T1.PRICE,0) <> Round(T1.U_SO_TRM + T1.U_SO_TP1 + T1.U_SO_TP2 + T1.U_SO_TP3 + T1.U_SO_TP4 + T1.U_SO_TP5 + T1.U_SO_TP6 + T1.U_SO_TP7,0))
			OR (ROUND(T1.U_SO_TRM,2) <> Round(Round(U_SO_LUASM2,4) * round(U_SO_PrcM2,4),2))
			OR (ROUND(U_SO_TP1,4) <> Round(ROUND(U_SO_QP1,4) * ROUND(U_SO_P1Prc,4),4))
			OR (ROUND(U_SO_TP2,4) <> Round(ROUND(U_SO_QP2,4) * ROUND(U_SO_P2Prc,4),4))
			OR (ROUND(U_SO_TP3,4) <> Round(ROUND(U_SO_QP3,4) * ROUND(U_SO_P3Prc,4),4))
			OR (ROUND(U_SO_TP4,4) <> Round(ROUND(U_SO_QP4,4) * ROUND(U_SO_P4Prc,4),4))
			OR (ROUND(U_SO_TP5,4) <> Round(ROUND(U_SO_QP5,4) * ROUND(U_SO_P5Prc,4),4))
			OR (ROUND(U_SO_TP6,4) <> Round(ROUND(U_SO_QP6,4) * ROUND(U_SO_P6Prc,4),4))
			OR (ROUND(U_SO_TP7,4) <> Round(ROUND(U_SO_QP7,4) * ROUND(U_SO_P7Prc,4),4))
-- Dibuat Optional karena harus sesuai dengan permintaan customer dimana job kode tidak diisi (double glass, DLL)
--			OR ((T1.U_SO_P1 IS NULL OR T1.U_SO_P1 = '') 
--				AND (T1.U_SO_P2 IS NULL OR T1.U_SO_P2 = '')
--				AND (T1.U_SO_P3 IS NULL OR T1.U_SO_P3 = '') 
--				AND (T1.U_SO_P4 IS NULL OR T1.U_SO_P4 = '') 
--				AND (T1.U_SO_P5 IS NULL OR T1.U_SO_P5 = '') 
--				AND (T1.U_SO_P6 IS NULL OR T1.U_SO_P6 = '') 
--				AND (T1.U_SO_P7 IS NULL OR T1.U_SO_P7 = ''))
-- Jika Quantity tidak diisi dan kode diisi
			OR (((T1.U_SO_QP1 IS NULL OR T1.U_SO_QP1 = 0 ) AND (T1.U_SO_P1 IS NOT NULL AND T1.U_SO_P1 <> ''))
				OR ((T1.U_SO_QP2 IS NULL OR T1.U_SO_QP2 = 0 ) AND (T1.U_SO_P2 IS NOT NULL AND T1.U_SO_P2 <> ''))			
				OR ((T1.U_SO_QP3 IS NULL OR T1.U_SO_QP3 = 0 ) AND (T1.U_SO_P3 IS NOT NULL AND T1.U_SO_P3 <> ''))
				OR ((T1.U_SO_QP4 IS NULL OR T1.U_SO_QP4 = 0 ) AND (T1.U_SO_P4 IS NOT NULL AND T1.U_SO_P4 <> ''))
				OR ((T1.U_SO_QP5 IS NULL OR T1.U_SO_QP5 = 0 ) AND (T1.U_SO_P5 IS NOT NULL AND T1.U_SO_P5 <> ''))
				OR ((T1.U_SO_QP6 IS NULL OR T1.U_SO_QP6 = 0 ) AND (T1.U_SO_P6 IS NOT NULL AND T1.U_SO_P6 <> ''))
				OR ((T1.U_SO_QP7 IS NULL OR T1.U_SO_QP7 = 0 ) AND (T1.U_SO_P7 IS NOT NULL AND T1.U_SO_P7 <> '')))
-- Jika Quantity diisi dan kode tidak diisi
			OR (((T1.U_SO_QP1 IS NOT NULL AND T1.U_SO_QP1 <> 0 ) AND (T1.U_SO_P1 IS NULL OR T1.U_SO_P1 = ''))
				OR ((T1.U_SO_QP2 IS NOT NULL AND T1.U_SO_QP2 <> 0 ) AND (T1.U_SO_P2 IS NULL OR T1.U_SO_P2 = ''))			
				OR ((T1.U_SO_QP3 IS NOT NULL AND T1.U_SO_QP3 <> 0 ) AND (T1.U_SO_P3 IS NULL OR T1.U_SO_P3 = ''))
				OR ((T1.U_SO_QP4 IS NOT NULL AND T1.U_SO_QP4 <> 0 ) AND (T1.U_SO_P4 IS NULL OR T1.U_SO_P4 = ''))
				OR ((T1.U_SO_QP5 IS NOT NULL AND T1.U_SO_QP5 <> 0 ) AND (T1.U_SO_P5 IS NULL OR T1.U_SO_P5 = ''))
				OR ((T1.U_SO_QP6 IS NOT NULL AND T1.U_SO_QP6 <> 0 ) AND (T1.U_SO_P6 IS NULL OR T1.U_SO_P6 = ''))
				OR ((T1.U_SO_QP7 IS NOT NULL AND T1.U_SO_QP7 <> 0 ) AND (T1.U_SO_P7 IS NULL OR T1.U_SO_P7 = '')))	
-- jika RP Job Tidak diisi dan Total job diisi	
			OR (((T1.U_SO_P1Prc IS NULL OR T1.U_SO_P1Prc = 0 ) AND (T1.U_SO_TP1 IS NOT NULL AND T1.U_SO_TP1 <> 0))
				OR ((T1.U_SO_P2Prc IS NULL OR T1.U_SO_P2Prc = 0 ) AND (T1.U_SO_TP2 IS NOT NULL AND T1.U_SO_TP2 <> 0))			
				OR ((T1.U_SO_P3Prc IS NULL OR T1.U_SO_P3Prc = 0 ) AND (T1.U_SO_TP3 IS NOT NULL AND T1.U_SO_TP3 <> 0))
				OR ((T1.U_SO_P4Prc IS NULL OR T1.U_SO_P4Prc = 0 ) AND (T1.U_SO_TP4 IS NOT NULL AND T1.U_SO_TP4 <> 0))
				OR ((T1.U_SO_P5Prc IS NULL OR T1.U_SO_P5Prc = 0 ) AND (T1.U_SO_TP5 IS NOT NULL AND T1.U_SO_TP5 <> 0))
				OR ((T1.U_SO_P6Prc IS NULL OR T1.U_SO_P6Prc = 0 ) AND (T1.U_SO_TP6 IS NOT NULL AND T1.U_SO_TP6 <> 0))
				OR ((T1.U_SO_P7Prc IS NULL OR T1.U_SO_P7Prc = 0 ) AND (T1.U_SO_TP7 IS NOT NULL AND T1.U_SO_TP7 <> 0)))
-- jika RP Job diisi dan Total job tidak diisi				
			OR (((T1.U_SO_P1Prc IS NOT NULL AND T1.U_SO_P1Prc <> 0 ) AND (T1.U_SO_TP1 IS NULL OR T1.U_SO_TP1 = 0))
				OR ((T1.U_SO_P2Prc IS NOT NULL AND T1.U_SO_P2Prc <> 0 ) AND (T1.U_SO_TP2 IS NULL OR T1.U_SO_TP2 = 0))			
				OR ((T1.U_SO_P3Prc IS NOT NULL AND T1.U_SO_P3Prc <> 0 ) AND (T1.U_SO_TP3 IS NULL OR T1.U_SO_TP3 = 0))
				OR ((T1.U_SO_P4Prc IS NOT NULL AND T1.U_SO_P4Prc <> 0 ) AND (T1.U_SO_TP4 IS NULL OR T1.U_SO_TP4 = 0))
				OR ((T1.U_SO_P5Prc IS NOT NULL AND T1.U_SO_P5Prc <> 0 ) AND (T1.U_SO_TP5 IS NULL OR T1.U_SO_TP5 = 0))
				OR ((T1.U_SO_P6Prc IS NOT NULL AND T1.U_SO_P6Prc <> 0 ) AND (T1.U_SO_TP6 IS NULL OR T1.U_SO_TP6 = 0))
				OR ((T1.U_SO_P7Prc IS NOT NULL AND T1.U_SO_P7Prc <> 0 ) AND (T1.U_SO_TP7 IS NULL OR T1.U_SO_TP7 = 0)))
			)
-- Jika terdapat data yang di lock dengan kondisi sebagai berikut
		IF @countRecord = 1			
		BEGIN
-- Jika Penjualan kaca Dan Jasa
			IF @WhsCode = 'FG-001' AND @ItemCode NOT Like 'CS%'
			BEGIN
-- Jika Quantity Tidak Diisi
				If @Quantity = 0 OR @Quantity IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Quantity!!! FG-001 != CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
-- Jika Unit Price Tidak Diisi
--				ELSE If @Price = 0 OR @Price IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Unit Price!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
--				END
------ Jika Unit Price Tidak Sama Dengan Total RM + Total Job
--				ELSE If @Price <> @TotalALLRM
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY???  Total Price Harus Sama Dengan TotalRM + TotalJob1 SAMPAI TotalJob7 Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1) + ' Please Edit SO Price  FG-001 != CS'
--				END
				
-- Jika Kode Jenis Kaca Tidak Diisi	
				ELSE If @KodeJenisKaca = '' OR @KodeJenisKaca IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT KODE JENIS KACA TEBAL!!!  FG-001 != CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
-- Jika Jenis Kaca Tidak Diisi
				ELSE If @JenisKaca = '' OR @JenisKaca IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT JENIS KACA !!!  FG-001 != CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END				
-- Jika Tebal Tidak Diisi				
				ELSE If @Tebal = 0 OR @Tebal IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT TEBAL!!!  FG-001 != CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END
-- Jika Warna Tidak Diisi				
				ELSE If @Warna = '' OR @Warna IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT WARNA!!!  FG-001 != CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
-- Jika Keterangan Tidak Diisi				
				ELSE If @Keterangan = '' OR @Keterangan IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT KETERANGAN!!!  FG-001 != CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 	
				END
-- Jika Luas M2 Tidak Diisi							
				ELSE If @LUASM2 = 0 OR @LUASM2 IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Luas M2!!!  FG-001 != CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END	
-- Jika Price M2 Tidak Diisi				
--				ELSE If @PriceM2 = 0 OR @PriceM2 IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Price M2!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
--				END	
-- Jika Total RM Tidak Diisi				
--				ELSE If @TotalRM = 0 OR @TotalRM IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Total Raw Material!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
--				END	

-- Jika Salah satu dari Job 01 sampai Job 07 tidak diisi maka eror
--				ELSE If ((@Job01 IS NULL OR @Job01 = '') 
--				AND (@Job02 IS NULL OR @Job02 = '')
--				AND (@Job03 IS NULL OR @Job03 = '') 
--				AND (@Job04 IS NULL OR @Job04 = '') 
--				AND (@Job05 IS NULL OR @Job05 = '') 
--				AND (@Job06 IS NULL OR @Job06 = '') 
--				AND (@Job07 IS NULL OR @Job07 = ''))
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT JOB !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
--				END

-- Modified karno 24 mei 2010
-- Jika Total RM <> LuasM2 * PriceM2
				ELSE IF(@TotalCalRM <> @TotalRM)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total RM (LUASM2 * PriceM2)!!!  FG-001 != CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				--ELSE IF(@TotalCalJob01 <> @TotalJob01)
				--BEGIN
				--	SELECT @error = 1, 
				--		@error_message = 'NOT SUCESSFULLY??? Check Total Job 1 (Qty Job* Rp Job)!!!  FG-001 != CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				--END

				ELSE IF(@TotalCalJob02 <> @TotalJob02)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 2 (Qty Job* Rp Job)!!!  FG-001 != CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob03 <> @TotalJob03)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 3 (Qty Job* Rp Job)!!!  FG-001 != CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob04 <> @TotalJob04)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 4 (Qty Job* Rp Job)!!!  FG-001 != CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob05 <> @TotalJob05)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 5 (Qty Job* Rp Job)!!!  FG-001 != CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob06 <> @TotalJob06)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 6 (Qty Job* Rp Job)!!!  FG-001 != CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob07 <> @TotalJob07)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 7 (Qty Job* Rp Job)!!!  FG-001 != CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END


-- Jika Kode Job diisi dan job Qty tidak diisi maka Job Qty wajib isi 
				ELSE IF((@Job01 <> '' AND @Job01 IS NOT NULL  ) AND (@JobQty01 IS NULL OR @JobQty01 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 01 DIISI, MAKA JOB QTY 01 HARUS DIISI !!!  FG-001 != CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job02 <> ''  AND @Job02 IS NOT NULL ) AND (@JobQty02 IS NULL OR @JobQty02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 02 DIISI, MAKA JOB QTY 02 HARUS DIISI !!!  FG-001 != CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job03 IS NOT NULL AND @Job03 <> '') AND (@JobQty03 IS NULL OR @JobQty03 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 03 DIISI, MAKA JOB QTY 03 HARUS DIISI !!!  FG-001 != CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job04 IS NOT NULL AND @Job04 <> '') AND (@JobQty04 IS NULL OR @JobQty04 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 04 DIISI, MAKA JOB QTY 04 HARUS DIISI !!!  FG-001 != CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job05 IS NOT NULL AND @Job05 <> '') AND (@JobQty05 IS NULL OR @JobQty05 = 0)) 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 05 DIISI, MAKA JOB QTY 05 HARUS DIISI !!!  FG-001 != CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job06 IS NOT NULL AND @Job06 <> '') AND (@JobQty06 IS NULL OR @JobQty06 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 06 DIISI, MAKA JOB QTY 06 HARUS DIISI !!!  FG-001 != CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job07 IS NOT NULL AND @Job07 <> '') AND (@JobQty07 IS NULL OR @JobQty07 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 07 DIISI, MAKA JOB QTY 07 HARUS DIISI !!!  FG-001 != CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

-- Jika Job Qty diisi dan job01 tidak diisi maka Job01 wajib isi 
				ELSE IF((@Job01 IS NULL OR @Job01 = '') AND (@JobQty01 IS NOT NULL AND @JobQty01 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 01 DIISI, MAKA JOB 01 HARUS DIISI !!!  FG-001 != CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END		
				ELSE IF((@Job02 IS NULL OR @Job02 = '') AND (@JobQty02 IS NOT NULL AND @JobQty02 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 02 DIISI, MAKA JOB 02 HARUS DIISI !!!  FG-001 != CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job03 IS NULL OR @Job03 = '') AND (@JobQty03 IS NOT NULL AND @JobQty03 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 03 DIISI, MAKA JOB 03 HARUS DIISI !!!  FG-001 != CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job04 IS NULL OR @Job04 = '') AND (@JobQty04 IS NOT NULL AND @JobQty04 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 04 DIISI, MAKA JOB 04 HARUS DIISI !!!  FG-001 != CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job05 IS NULL OR @Job05 = '') AND (@JobQty05 IS NOT NULL AND @JobQty05 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 05 DIISI, MAKA JOB 05 HARUS DIISI !!!  FG-001 != CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job06 IS NULL OR @Job06 = '') AND (@JobQty06 IS NOT NULL AND @JobQty06 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 06 DIISI, MAKA JOB 06 HARUS DIISI !!!  FG-001 != CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job07 IS NULL OR @Job07 = '') AND (@JobQty07 IS NOT NULL AND @JobQty07 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 07 DIISI, MAKA JOB 07 HARUS DIISI !!!  FG-001 != CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END		

-- Jika Total Job diisi dan job RP tidak diisi maka Job RP wajib isi 

				ELSE IF((@JobRP01 = 0 OR @JobRP01 IS NULL  ) AND (@TotalJob01 IS NOT NULL AND @TotalJob01 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 01 DIISI, MAKA JOB RP 01 HARUS DIISI !!!  FG-001 != CS  Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP02 = 0 OR @JobRP02 IS NULL  ) AND (@TotalJob02 IS NOT NULL AND @TotalJob02 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 02 DIISI, MAKA JOB RP 02 HARUS DIISI !!!  FG-001 != CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP03 = 0 OR @JobRP03 IS NULL  ) AND (@TotalJob03 IS NOT NULL AND @TotalJob03 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 03 DIISI, MAKA JOB RP 03 HARUS DIISI !!!  FG-001 != CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP04 = 0 OR @JobRP04 IS NULL  ) AND (@TotalJob04 IS NOT NULL AND @TotalJob04 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 04 DIISI, MAKA JOB RP 04 HARUS DIISI !!!  FG-001 != CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP05 = 0 OR @JobRP05 IS NULL  ) AND (@TotalJob05 IS NOT NULL AND @TotalJob05 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 05 DIISI, MAKA JOB RP 05 HARUS DIISI !!!  FG-001 != CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP06 = 0 OR @JobRP06 IS NULL  ) AND (@TotalJob06 IS NOT NULL AND @TotalJob06 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 06 DIISI, MAKA JOB RP 06 HARUS DIISI !!!  FG-001 != CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP07 = 0 OR @JobRP07 IS NULL  ) AND (@TotalJob07 IS NOT NULL AND @TotalJob07 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 07 DIISI, MAKA JOB RP 07 HARUS DIISI !!!  FG-001 != CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END

-- Jika Job RP diisi dan Total job tidak diisi maka Job RP wajib isi 

				ELSE IF((@JobRP01 <> 0 AND @JobRP01 IS NOT NULL  ) AND (@TotalJob01 IS NULL OR @TotalJob01 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 01 DIISI, MAKA TOTAL JOB 01 HARUS DIISI !!!  FG-001 != CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP02 <> 0 AND @JobRP02 IS NOT NULL  ) AND (@TotalJob02 IS NULL OR @TotalJob02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 02 DIISI, MAKA TOTAL JOB 02 HARUS DIISI !!!  FG-001 != CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP03 <> 0 AND @JobRP03 IS NOT NULL  ) AND (@TotalJob03 IS NULL OR @TotalJob02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 03 DIISI, MAKA TOTAL JOB 03 HARUS DIISI !!!  FG-001 != CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP04 <> 0 AND @JobRP04 IS NOT NULL  ) AND (@TotalJob04 IS NULL OR @TotalJob04 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 04 DIISI, MAKA TOTAL JOB 04 HARUS DIISI !!!  FG-001 != CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END	
				ELSE IF((@JobRP05 <> 0 AND @JobRP05 IS NOT NULL  ) AND (@TotalJob05 IS NULL OR @TotalJob05 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 05 DIISI, MAKA TOTAL JOB 05 HARUS DIISI !!!  FG-001 != CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP06 <> 0 AND @JobRP06 IS NOT NULL  ) AND (@TotalJob06 IS NULL OR @TotalJob06 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 06 DIISI, MAKA TOTAL JOB 06 HARUS DIISI !!!  FG-001 != CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP07 <> 0 AND @JobRP07 IS NOT NULL  ) AND (@TotalJob07 IS NULL OR @TotalJob07 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 07 DIISI, MAKA TOTAL JOB 07 HARUS DIISI !!!  FG-001 != CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
			
			END -- Warehouse Banding
		END -- Count Record
	
----------------------------------------------------------------------------------------------------------------
--  AKHIR --- JIKA Warehouse FG-001 Dengan kondisi Penjualan Kaca Dan Jasa, ItemCode Tidak Diawali dengan CS ---
----------------------------------------------------------------------------------------------------------------
-- TESTING 1 OK 
---------------------------------------------------------------------------------------------------
--  AWAL --- JIKA Warehouse FG-001 Dengan kondisi Penjualan Kaca Dan ItemCode Diawali dengan CS ---
---------------------------------------------------------------------------------------------------
--else IF @WhsCode = 'FG-001' AND @ItemCode Like 'CS%'
--BEGIN --Warehouse And Item 
		SET @countRecord = 0
		select TOP 1
		@VisOrder = VisOrder,
		@LineNum = LineNum,
		@WhsCode = WhsCode,
		@ItemCode = ItemCode,
		@Quantity = Quantity,
		@KodeJenisKaca = U_MIS_JNSKACATEB,
		@JenisKaca = U_MIS_JenisKaca,
		@Tebal = U_MIS_Tebal,
		@Warna = U_MIS_Warna,
		@Keterangan = U_MIS_Desc,		
		@LUASM2 = U_SO_LUASM2,
		@PriceM2 = U_SO_PrcM2,
		@TotalRM = Round(U_SO_TRM,2),
		@TotalCalRM = ROUND(ROUND(U_SO_LUASM2,4) * ROUND(U_SO_PrcM2,4),2),
-- jika total Job tidak sama dengan Qty * Price
		@TotalCalJob01 = ROUND(ROUND(U_SO_QP1,4) * ROUND(U_SO_P1Prc,4),4),
		@TotalCalJob02 = ROUND(ROUND(U_SO_QP2,4) * ROUND(U_SO_P2Prc,4),4),
		@TotalCalJob03 = ROUND(ROUND(U_SO_QP3,4) * ROUND(U_SO_P3Prc,4),4),
		@TotalCalJob04 = ROUND(ROUND(U_SO_QP4,4) * ROUND(U_SO_P4Prc,4),4),
		@TotalCalJob05 = ROUND(ROUND(U_SO_QP5,4) * ROUND(U_SO_P5Prc,4),4),
		@TotalCalJob06 = ROUND(ROUND(U_SO_QP6,4) * ROUND(U_SO_P6Prc,4),4),
		@TotalCalJob07 = ROUND(ROUND(U_SO_QP7,4) * ROUND(U_SO_P7Prc,4),4),		
		--@Price = ROUND(Price,0),
		--@TotalALLRM = Round(T1.U_SO_TRM + T1.U_SO_TP1 + T1.U_SO_TP2 + T1.U_SO_TP3 + T1.U_SO_TP4 + T1.U_SO_TP5 + T1.U_SO_TP6 + T1.U_SO_TP7,0),
		@Job01 = U_SO_P1, @JobQty01 = U_SO_QP1, @JobRp01 = U_SO_P1Prc, @TotalJob01 = ROUND(U_SO_TP1,4),
		@Job02 = U_SO_P2, @JobQty02 = U_SO_QP2, @JobRp02 = U_SO_P2Prc, @TotalJob02 = ROUND(U_SO_TP2,4),
		@Job03 = U_SO_P3, @JobQty03 = U_SO_QP3, @JobRp03 = U_SO_P3Prc, @TotalJob03 = ROUND(U_SO_TP3,4),
		@Job04 = U_SO_P4, @JobQty04 = U_SO_QP4, @JobRp04 = U_SO_P4Prc, @TotalJob04 = ROUND(U_SO_TP4,4),
		@Job05 = U_SO_P5, @JobQty05 = U_SO_QP5, @JobRp05 = U_SO_P5Prc, @TotalJob05 = ROUND(U_SO_TP5,4),
		@Job06 = U_SO_P6, @JobQty06 = U_SO_QP6, @JobRp06 = U_SO_P6Prc, @TotalJob06 = ROUND(U_SO_TP6,4),
		@Job07 = U_SO_P7, @JobQty07 = U_SO_QP7, @JobRp07 = U_SO_P7Prc, @TotalJob07 = ROUND(U_SO_TP7,4),
		@QtyLbr = U_MIS_QtyLbr,
		@countRecord = 1
		FROM DLN1 T1
		JOIN ODLN T0
		ON T1.DOCENTRY = T0.DOCENTRY
		WHERE T1.DOCENTRY = CAST(@list_of_cols_val_tab_del AS INT)
			AND DOCTYPE = 'I'
			AND WhsCode = 'FG-001' AND ItemCode Like 'CS%'
			AND 
			(	
			(T1.Quantity IS NULL OR T1.Quantity = 0) OR			
--			(T1.Price IS NULL OR T1.Price = 0) OR
-- Diround jadi 0 karena ada penjualan yang berdasarkan lembar
			--(Round(T1.PRICE,0) <> Round(T1.U_SO_TRM + T1.U_SO_TP1 + T1.U_SO_TP2 + T1.U_SO_TP3 + T1.U_SO_TP4 + T1.U_SO_TP5 + T1.U_SO_TP6 + T1.U_SO_TP7,0)) OR
			(T1.U_MIS_JNSKACATEB IS NULL OR T1.U_MIS_JNSKACATEB = '') OR
			(T1.U_MIS_JenisKaca IS NULL OR T1.U_MIS_JenisKaca= '') OR
			(T1.U_MIS_Tebal IS NULL OR T1.U_MIS_Tebal= 0) OR
			(T1.U_MIS_Warna IS NULL OR T1.U_MIS_Warna= '') OR
			(T1.U_MIS_Desc IS NULL OR T1.U_MIS_Desc= '') OR			
			(T1.U_SO_LUASM2 IS NULL OR T1.U_SO_LUASM2 = 0)  
--			(T1.U_SO_PrcM2 IS NULL OR T1.U_SO_PrcM2 = 0)  
--			(T1.U_SO_TRM IS NULL OR T1.U_SO_TRM = 0)
-- karno
			OR (ROUND(T1.U_SO_TRM,2) <> Round(Round(U_SO_LUASM2,4) * round(U_SO_PrcM2,4),2))
			OR (ROUND(U_SO_TP1,4) <> Round(ROUND(U_SO_QP1,4) * ROUND(U_SO_P1Prc,4),4))
			OR (ROUND(U_SO_TP2,4) <> Round(ROUND(U_SO_QP2,4) * ROUND(U_SO_P2Prc,4),4))
			OR (ROUND(U_SO_TP3,4) <> Round(ROUND(U_SO_QP3,4) * ROUND(U_SO_P3Prc,4),4))
			OR (ROUND(U_SO_TP4,4) <> Round(ROUND(U_SO_QP4,4) * ROUND(U_SO_P4Prc,4),4))
			OR (ROUND(U_SO_TP5,4) <> Round(ROUND(U_SO_QP5,4) * ROUND(U_SO_P5Prc,4),4))
			OR (ROUND(U_SO_TP6,4) <> Round(ROUND(U_SO_QP6,4) * ROUND(U_SO_P6Prc,4),4))
			OR (ROUND(U_SO_TP7,4) <> Round(ROUND(U_SO_QP7,4) * ROUND(U_SO_P7Prc,4),4))
			OR (((T1.U_SO_QP1 IS NULL OR T1.U_SO_QP1 = 0 ) AND (T1.U_SO_P1 IS NOT NULL AND T1.U_SO_P1 <> ''))
				OR ((T1.U_SO_QP2 IS NULL OR T1.U_SO_QP2 = 0 ) AND (T1.U_SO_P2 IS NOT NULL AND T1.U_SO_P2 <> ''))			
				OR ((T1.U_SO_QP3 IS NULL OR T1.U_SO_QP3 = 0 ) AND (T1.U_SO_P3 IS NOT NULL AND T1.U_SO_P3 <> ''))
				OR ((T1.U_SO_QP4 IS NULL OR T1.U_SO_QP4 = 0 ) AND (T1.U_SO_P4 IS NOT NULL AND T1.U_SO_P4 <> ''))
				OR ((T1.U_SO_QP5 IS NULL OR T1.U_SO_QP5 = 0 ) AND (T1.U_SO_P5 IS NOT NULL AND T1.U_SO_P5 <> ''))
				OR ((T1.U_SO_QP6 IS NULL OR T1.U_SO_QP6 = 0 ) AND (T1.U_SO_P6 IS NOT NULL AND T1.U_SO_P6 <> ''))
				OR ((T1.U_SO_QP7 IS NULL OR T1.U_SO_QP7 = 0 ) AND (T1.U_SO_P7 IS NOT NULL AND T1.U_SO_P7 <> '')))
			OR (((T1.U_SO_QP1 IS NOT NULL AND T1.U_SO_QP1 <> 0 ) AND (T1.U_SO_P1 IS NULL OR T1.U_SO_P1 = ''))
				OR ((T1.U_SO_QP2 IS NOT NULL AND T1.U_SO_QP2 <> 0 ) AND (T1.U_SO_P2 IS NULL OR T1.U_SO_P2 = ''))			
				OR ((T1.U_SO_QP3 IS NOT NULL AND T1.U_SO_QP3 <> 0 ) AND (T1.U_SO_P3 IS NULL OR T1.U_SO_P3 = ''))
				OR ((T1.U_SO_QP4 IS NOT NULL AND T1.U_SO_QP4 <> 0 ) AND (T1.U_SO_P4 IS NULL OR T1.U_SO_P4 = ''))
				OR ((T1.U_SO_QP5 IS NOT NULL AND T1.U_SO_QP5 <> 0 ) AND (T1.U_SO_P5 IS NULL OR T1.U_SO_P5 = ''))
				OR ((T1.U_SO_QP6 IS NOT NULL AND T1.U_SO_QP6 <> 0 ) AND (T1.U_SO_P6 IS NULL OR T1.U_SO_P6 = ''))
				OR ((T1.U_SO_QP7 IS NOT NULL AND T1.U_SO_QP7 <> 0 ) AND (T1.U_SO_P7 IS NULL OR T1.U_SO_P7 = '')))	
	
			OR (((T1.U_SO_P1Prc IS NULL OR T1.U_SO_P1Prc = 0 ) AND (T1.U_SO_TP1 IS NOT NULL AND T1.U_SO_TP1 <> 0))
				OR ((T1.U_SO_P2Prc IS NULL OR T1.U_SO_P2Prc = 0 ) AND (T1.U_SO_TP2 IS NOT NULL AND T1.U_SO_TP2 <> 0))			
				OR ((T1.U_SO_P3Prc IS NULL OR T1.U_SO_P3Prc = 0 ) AND (T1.U_SO_TP3 IS NOT NULL AND T1.U_SO_TP3 <> 0))
				OR ((T1.U_SO_P4Prc IS NULL OR T1.U_SO_P4Prc = 0 ) AND (T1.U_SO_TP4 IS NOT NULL AND T1.U_SO_TP4 <> 0))
				OR ((T1.U_SO_P5Prc IS NULL OR T1.U_SO_P5Prc = 0 ) AND (T1.U_SO_TP5 IS NOT NULL AND T1.U_SO_TP5 <> 0))
				OR ((T1.U_SO_P6Prc IS NULL OR T1.U_SO_P6Prc = 0 ) AND (T1.U_SO_TP6 IS NOT NULL AND T1.U_SO_TP6 <> 0))
				OR ((T1.U_SO_P7Prc IS NULL OR T1.U_SO_P7Prc = 0 ) AND (T1.U_SO_TP7 IS NOT NULL AND T1.U_SO_TP7 <> 0)))
			
			
			OR (((T1.U_SO_P1Prc IS NOT NULL AND T1.U_SO_P1Prc <> 0 ) AND (T1.U_SO_TP1 IS NULL OR T1.U_SO_TP1 = 0))
				OR ((T1.U_SO_P2Prc IS NOT NULL AND T1.U_SO_P2Prc <> 0 ) AND (T1.U_SO_TP2 IS NULL OR T1.U_SO_TP2 = 0))			
				OR ((T1.U_SO_P3Prc IS NOT NULL AND T1.U_SO_P3Prc <> 0 ) AND (T1.U_SO_TP3 IS NULL OR T1.U_SO_TP3 = 0))
				OR ((T1.U_SO_P4Prc IS NOT NULL AND T1.U_SO_P4Prc <> 0 ) AND (T1.U_SO_TP4 IS NULL OR T1.U_SO_TP4 = 0))
				OR ((T1.U_SO_P5Prc IS NOT NULL AND T1.U_SO_P5Prc <> 0 ) AND (T1.U_SO_TP5 IS NULL OR T1.U_SO_TP5 = 0))
				OR ((T1.U_SO_P6Prc IS NOT NULL AND T1.U_SO_P6Prc <> 0 ) AND (T1.U_SO_TP6 IS NULL OR T1.U_SO_TP6 = 0))
				OR ((T1.U_SO_P7Prc IS NOT NULL AND T1.U_SO_P7Prc <> 0 ) AND (T1.U_SO_TP7 IS NULL OR T1.U_SO_TP7 = 0)))

			)
		IF @countRecord = 1			
		BEGIN -- Count Record
			IF @WhsCode = 'FG-001' AND @ItemCode Like 'CS%'
			BEGIN -- Warehouse Banding
-- Jika Quantity Tidak Diisi
				If @Quantity = 0 OR @Quantity IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Quantity!!!  FG-001 = CS ' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
-- Jika Price Tidak Diisi
--				ELSE If @Price = 0 OR @Price IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Unit Price!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
--				END
---- Jika Price Tidak Sama Dengan Total RM + Total Job
				--ELSE If @Price <> @TotalALLRM
				--BEGIN
				--	SELECT @error = 1, 
				--		@error_message = 'NOT SUCESSFULLY???  Total Price Harus Sama Dengan TotalRM + TotalJob1 SAMPAI TotalJob7  FG-001 = CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1) + ' Please Edit SO Price'
				--END
-- Jika Kode Jenis Kaca Tidak Diisi	
				ELSE If @KodeJenisKaca = '' OR @KodeJenisKaca IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT KODE JENIS KACA TEBAL!!!  FG-001 = CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
-- Jika Jenis Kaca Tidak Diisi
				ELSE If @JenisKaca = '' OR @JenisKaca IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT JENIS KACA !!!  FG-001 = CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END				
-- Jika Tebal Tidak Diisi				
				ELSE If @Tebal = 0 OR @Tebal IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT TEBAL!!!  FG-001 = CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END
-- Jika Warna Tidak Diisi
				ELSE If @Warna = '' OR @Warna IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT WARNA!!!  FG-001 = CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
-- Jika Keterangan Tidak Diisi
				ELSE If @Keterangan = '' OR @Keterangan IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT KETERANGAN!!!  FG-001 = CS' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 	
				END
-- Jika Luas M2 Tidak Diisi			
				ELSE If @LUASM2 = 0 OR @LUASM2 IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Luas M2!!!  FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END	
-- Jika Price M2 Tidak Diisi
--				ELSE If @PriceM2 = 0 OR @PriceM2 IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Price M2!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
--				END	
---- Jika Total RM Tidak Diisi
--				ELSE If @TotalRM = 0 OR @TotalRM IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Total Raw Material!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
--				END	


-- Modified karno 24 mei 2010
				ELSE IF(@TotalCalRM <> @TotalRM)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total RM (LUASM2 * PriceM2)!!!  FG-001 = CS' + @object_type +', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob01 <> @TotalJob01)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 1 (Qty Job* Rp Job)!!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob02 <> @TotalJob02)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 2 (Qty Job* Rp Job)!!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob03 <> @TotalJob03)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 3 (Qty Job* Rp Job)!!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob04 <> @TotalJob04)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 4 (Qty Job* Rp Job)!!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob05 <> @TotalJob05)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 5 (Qty Job* Rp Job)!!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob06 <> @TotalJob06)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 6 (Qty Job* Rp Job)!!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob07 <> @TotalJob07)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 7 (Qty Job* Rp Job)!!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END



-- Jika Kode Job diisi dan job Qty tidak diisi maka Job Qty wajib isi 

				ELSE IF((@Job01 <> '' AND @Job01 IS NOT NULL  ) AND (@JobQty01 IS NULL OR @JobQty01 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 01 DIISI, MAKA JOB QTY 01 HARUS DIISI !!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job02 <> ''  AND @Job02 IS NOT NULL ) AND (@JobQty02 IS NULL OR @JobQty02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 02 DIISI, MAKA JOB QTY 02 HARUS DIISI !!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END

				ELSE IF((@Job03 IS NOT NULL AND @Job03 <> '') AND (@JobQty03 IS NULL OR @JobQty03 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 03 DIISI, MAKA JOB QTY 03 HARUS DIISI !!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job04 IS NOT NULL AND @Job04 <> '') AND (@JobQty04 IS NULL OR @JobQty04 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 04 DIISI, MAKA JOB QTY 04 HARUS DIISI !!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job05 IS NOT NULL AND @Job05 <> '') AND (@JobQty05 IS NULL OR @JobQty05 = 0)) 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 05 DIISI, MAKA JOB QTY 05 HARUS DIISI !!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job06 IS NOT NULL AND @Job06 <> '') AND (@JobQty06 IS NULL OR @JobQty06 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 06 DIISI, MAKA JOB QTY 06 HARUS DIISI !!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job07 IS NOT NULL AND @Job07 <> '') AND (@JobQty07 IS NULL OR @JobQty07 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 07 DIISI, MAKA JOB QTY 07 HARUS DIISI !!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

-- Jika Job Qty diisi dan job01 tidak diisi maka Job01 wajib isi 
				ELSE IF((@Job01 IS NULL OR @Job01 = '') AND (@JobQty01 IS NOT NULL AND @JobQty01 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 01 DIISI, MAKA JOB 01 HARUS DIISI !!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END		
				ELSE IF((@Job02 IS NULL OR @Job02 = '') AND (@JobQty02 IS NOT NULL AND @JobQty02 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 02 DIISI, MAKA JOB 02 HARUS DIISI !!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job03 IS NULL OR @Job03 = '') AND (@JobQty03 IS NOT NULL AND @JobQty03 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 03 DIISI, MAKA JOB 03 HARUS DIISI !!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job04 IS NULL OR @Job04 = '') AND (@JobQty04 IS NOT NULL AND @JobQty04 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 04 DIISI, MAKA JOB 04 HARUS DIISI !!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job05 IS NULL OR @Job05 = '') AND (@JobQty05 IS NOT NULL AND @JobQty05 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 05 DIISI, MAKA JOB 05 HARUS DIISI !!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job06 IS NULL OR @Job06 = '') AND (@JobQty06 IS NOT NULL AND @JobQty06 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 06 DIISI, MAKA JOB 06 HARUS DIISI !!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job07 IS NULL OR @Job07 = '') AND (@JobQty07 IS NOT NULL AND @JobQty07 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 07 DIISI, MAKA JOB 07 HARUS DIISI !!! FG-001 = CS' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + '   Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END		

-- Jika Total Job diisi dan job RP tidak diisi maka Job RP wajib isi 

				ELSE IF((@JobRP01 = 0 OR @JobRP01 IS NULL  ) AND (@TotalJob01 IS NOT NULL AND @TotalJob01 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 01 DIISI, MAKA JOB RP 01 HARUS DIISI !!!  FG-001 = CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP02 = 0 OR @JobRP02 IS NULL  ) AND (@TotalJob02 IS NOT NULL AND @TotalJob02 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 02 DIISI, MAKA JOB RP 02 HARUS DIISI !!!  FG-001 = CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP03 = 0 OR @JobRP03 IS NULL  ) AND (@TotalJob03 IS NOT NULL AND @TotalJob03 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 03 DIISI, MAKA JOB RP 03 HARUS DIISI !!!  FG-001 = CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP04 = 0 OR @JobRP04 IS NULL  ) AND (@TotalJob04 IS NOT NULL AND @TotalJob04 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 04 DIISI, MAKA JOB RP 04 HARUS DIISI !!!  FG-001 = CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP05 = 0 OR @JobRP05 IS NULL  ) AND (@TotalJob05 IS NOT NULL AND @TotalJob05 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 05 DIISI, MAKA JOB RP 05 HARUS DIISI !!!  FG-001 = CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP06 = 0 OR @JobRP06 IS NULL  ) AND (@TotalJob06 IS NOT NULL AND @TotalJob06 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 06 DIISI, MAKA JOB RP 06 HARUS DIISI !!!  FG-001 = CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP07 = 0 OR @JobRP07 IS NULL  ) AND (@TotalJob07 IS NOT NULL AND @TotalJob07 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 07 DIISI, MAKA JOB RP 07 HARUS DIISI !!!  FG-001 = CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END

-- Jika Job RP diisi dan Total job tidak diisi maka Job RP wajib isi 

				ELSE IF((@JobRP01 <> 0 AND @JobRP01 IS NOT NULL  ) AND (@TotalJob01 IS NULL OR @TotalJob01 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 01 DIISI, MAKA TOTAL JOB 01 HARUS DIISI !!!  FG-001 = CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP02 <> 0 AND @JobRP02 IS NOT NULL  ) AND (@TotalJob02 IS NULL OR @TotalJob02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 02 DIISI, MAKA TOTAL JOB 02 HARUS DIISI !!!  FG-001 = CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP03 <> 0 AND @JobRP03 IS NOT NULL  ) AND (@TotalJob03 IS NULL OR @TotalJob02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 03 DIISI, MAKA TOTAL JOB 03 HARUS DIISI !!!  FG-001 = CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP04 <> 0 AND @JobRP04 IS NOT NULL  ) AND (@TotalJob04 IS NULL OR @TotalJob04 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 04 DIISI, MAKA TOTAL JOB 04 HARUS DIISI !!!  FG-001 = CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END	
				ELSE IF((@JobRP05 <> 0 AND @JobRP05 IS NOT NULL  ) AND (@TotalJob05 IS NULL OR @TotalJob05 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 05 DIISI, MAKA TOTAL JOB 05 HARUS DIISI !!!  FG-001 = CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP06 <> 0 AND @JobRP06 IS NOT NULL  ) AND (@TotalJob06 IS NULL OR @TotalJob06 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 06 DIISI, MAKA TOTAL JOB 06 HARUS DIISI !!!  FG-001 = CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP07 <> 0 AND @JobRP07 IS NOT NULL  ) AND (@TotalJob07 IS NULL OR @TotalJob07 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 07 DIISI, MAKA TOTAL JOB 07 HARUS DIISI !!!  FG-001 = CS Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END


			END --Warehouse Banding
		END -- CountRecord
-----------------------------------------------------------------------------------------------------
----  AKHIR --- JIKA Warehouse FG-001 Dengan kondisi Penjualan Kaca Dan ItemCode Diawali dengan CS ---
-----------------------------------------------------------------------------------------------------
-- TESTING 2
-----------------------------------------------------------------------------------------------------
----  AWAL --- JIKA Warehouse FG-002 Dengan kondisi JASA ---
-----------------------------------------------------------------------------------------------------
--else IF @WhsCode = 'FG-002'
--BEGIN -- Warehouse and Item
	SET @countRecord = 0	
		select TOP 1
		@VisOrder = VisOrder,
		@LineNum = LineNum,
		@WhsCode = WhsCode,
		@ItemCode = ItemCode,
		@Quantity = Quantity,
		@KodeJenisKaca = U_MIS_JNSKACATEB,
		@JenisKaca = U_MIS_JenisKaca,
		@Tebal = U_MIS_Tebal,
		@Warna = U_MIS_Warna,
		@Keterangan = U_MIS_Desc,		
		@LUASM2 = U_SO_LUASM2,
		@PriceM2 = U_SO_PrcM2,
		@TotalRM = ROUND(U_SO_TRM,2),
		@TotalCalRM = ROUND(ROUND(U_SO_LUASM2,4) * ROUND(U_SO_PrcM2,4),2),
-- jika total Job tidak sama dengan Qty * Price
		@TotalCalJob01 = ROUND(ROUND(U_SO_QP1,4) * ROUND(U_SO_P1Prc,4),4),
		@TotalCalJob02 = ROUND(ROUND(U_SO_QP2,4) * ROUND(U_SO_P2Prc,4),4),
		@TotalCalJob03 = ROUND(ROUND(U_SO_QP3,4) * ROUND(U_SO_P3Prc,4),4),
		@TotalCalJob04 = ROUND(ROUND(U_SO_QP4,4) * ROUND(U_SO_P4Prc,4),4),
		@TotalCalJob05 = ROUND(ROUND(U_SO_QP5,4) * ROUND(U_SO_P5Prc,4),4),
		@TotalCalJob06 = ROUND(ROUND(U_SO_QP6,4) * ROUND(U_SO_P6Prc,4),4),
		@TotalCalJob07 = ROUND(ROUND(U_SO_QP7,4) * ROUND(U_SO_P7Prc,4),4),		
		--@Price = ROUND(Price,0),		
		--@TotalALLRM = Round(T1.U_SO_TRM + T1.U_SO_TP1 + T1.U_SO_TP2 + T1.U_SO_TP3 + T1.U_SO_TP4 + T1.U_SO_TP5 + T1.U_SO_TP6 + T1.U_SO_TP7,0),
		@Job01 = U_SO_P1, @JobQty01 = U_SO_QP1, @JobRp01 = U_SO_P1Prc, @TotalJob01 = ROUND(U_SO_TP1,4),
		@Job02 = U_SO_P2, @JobQty02 = U_SO_QP2, @JobRp02 = U_SO_P2Prc, @TotalJob02 = ROUND(U_SO_TP2,4),
		@Job03 = U_SO_P3, @JobQty03 = U_SO_QP3, @JobRp03 = U_SO_P3Prc, @TotalJob03 = ROUND(U_SO_TP3,4),
		@Job04 = U_SO_P4, @JobQty04 = U_SO_QP4, @JobRp04 = U_SO_P4Prc, @TotalJob04 = ROUND(U_SO_TP4,4),
		@Job05 = U_SO_P5, @JobQty05 = U_SO_QP5, @JobRp05 = U_SO_P5Prc, @TotalJob05 = ROUND(U_SO_TP5,4),
		@Job06 = U_SO_P6, @JobQty06 = U_SO_QP6, @JobRp06 = U_SO_P6Prc, @TotalJob06 = ROUND(U_SO_TP6,4),
		@Job07 = U_SO_P7, @JobQty07 = U_SO_QP7, @JobRp07 = U_SO_P7Prc, @TotalJob07 = ROUND(U_SO_TP7,4),
		@countRecord = 1
		FROM DLN1 T1
		JOIN ODLN T0
		ON T1.DOCENTRY = T0.DOCENTRY
		WHERE T1.DOCENTRY = CAST(@list_of_cols_val_tab_del AS INT)
			AND DOCTYPE = 'I'
			AND WhsCode = 'FG-002' 
			AND 
			(	
			(T1.Quantity IS NULL OR T1.Quantity = 0) OR			
--			(T1.Price IS NULL OR T1.Price = 0) OR
			(T1.U_MIS_JNSKACATEB IS NOT NULL AND T1.U_MIS_JNSKACATEB <> '') OR
			(T1.U_MIS_JenisKaca IS NOT NULL AND T1.U_MIS_JenisKaca <> '') OR
			(T1.U_MIS_Tebal IS NOT NULL AND T1.U_MIS_Tebal <> 0) OR
			(T1.U_MIS_Warna IS NOT NULL AND T1.U_MIS_Warna <> '') OR
			(T1.U_MIS_Desc IS NOT NULL AND T1.U_MIS_Desc <> '') OR			
--			(T1.U_SO_LUASM2 IS NULL OR T1.U_SO_LUASM2 = 0) OR
			(T1.U_SO_PrcM2 IS NOT NULL AND T1.U_SO_PrcM2 <> 0) OR
			(T1.U_SO_TRM IS NOT NULL AND T1.U_SO_TRM <> 0)
-- karno
-- Diround jadi 0 karena ada penjualan yang berdasarkan lembar			
			--OR (Round(T1.PRICE,0) <> Round(T1.U_SO_TRM + T1.U_SO_TP1 + T1.U_SO_TP2 + T1.U_SO_TP3 + T1.U_SO_TP4 + T1.U_SO_TP5 + T1.U_SO_TP6 + T1.U_SO_TP7,0))
			OR (ROUND(T1.U_SO_TRM,2) <> Round(Round(U_SO_LUASM2,4) * round(U_SO_PrcM2,4),2))
			OR (ROUND(U_SO_TP1,4) <> Round(ROUND(U_SO_QP1,4) * ROUND(U_SO_P1Prc,4),4))
			OR (ROUND(U_SO_TP2,4) <> Round(ROUND(U_SO_QP2,4) * ROUND(U_SO_P2Prc,4),4))
			OR (ROUND(U_SO_TP3,4) <> Round(ROUND(U_SO_QP3,4) * ROUND(U_SO_P3Prc,4),4))
			OR (ROUND(U_SO_TP4,4) <> Round(ROUND(U_SO_QP4,4) * ROUND(U_SO_P4Prc,4),4))
			OR (ROUND(U_SO_TP5,4) <> Round(ROUND(U_SO_QP5,4) * ROUND(U_SO_P5Prc,4),4))
			OR (ROUND(U_SO_TP6,4) <> Round(ROUND(U_SO_QP6,4) * ROUND(U_SO_P6Prc,4),4))
			OR (ROUND(U_SO_TP7,4) <> Round(ROUND(U_SO_QP7,4) * ROUND(U_SO_P7Prc,4),4))
			OR ((T1.U_SO_P1 IS NULL OR T1.U_SO_P1 = '') 
				AND (T1.U_SO_P2 IS NULL OR T1.U_SO_P2 = '')
				AND (T1.U_SO_P3 IS NULL OR T1.U_SO_P3 = '') 
				AND (T1.U_SO_P4 IS NULL OR T1.U_SO_P4 = '') 
				AND (T1.U_SO_P5 IS NULL OR T1.U_SO_P5 = '') 
				AND (T1.U_SO_P6 IS NULL OR T1.U_SO_P6 = '') 
				AND (T1.U_SO_P7 IS NULL OR T1.U_SO_P7 = ''))
			OR (((T1.U_SO_QP1 IS NULL OR T1.U_SO_QP1 = 0 ) AND (T1.U_SO_P1 IS NOT NULL AND T1.U_SO_P1 <> ''))
				OR ((T1.U_SO_QP2 IS NULL OR T1.U_SO_QP2 = 0 ) AND (T1.U_SO_P2 IS NOT NULL AND T1.U_SO_P2 <> ''))			
				OR ((T1.U_SO_QP3 IS NULL OR T1.U_SO_QP3 = 0 ) AND (T1.U_SO_P3 IS NOT NULL AND T1.U_SO_P3 <> ''))
				OR ((T1.U_SO_QP4 IS NULL OR T1.U_SO_QP4 = 0 ) AND (T1.U_SO_P4 IS NOT NULL AND T1.U_SO_P4 <> ''))
				OR ((T1.U_SO_QP5 IS NULL OR T1.U_SO_QP5 = 0 ) AND (T1.U_SO_P5 IS NOT NULL AND T1.U_SO_P5 <> ''))
				OR ((T1.U_SO_QP6 IS NULL OR T1.U_SO_QP6 = 0 ) AND (T1.U_SO_P6 IS NOT NULL AND T1.U_SO_P6 <> ''))
				OR ((T1.U_SO_QP7 IS NULL OR T1.U_SO_QP7 = 0 ) AND (T1.U_SO_P7 IS NOT NULL AND T1.U_SO_P7 <> '')))
			OR (((T1.U_SO_QP1 IS NOT NULL AND T1.U_SO_QP1 <> 0 ) AND (T1.U_SO_P1 IS NULL OR T1.U_SO_P1 = ''))
				OR ((T1.U_SO_QP2 IS NOT NULL AND T1.U_SO_QP2 <> 0 ) AND (T1.U_SO_P2 IS NULL OR T1.U_SO_P2 = ''))			
				OR ((T1.U_SO_QP3 IS NOT NULL AND T1.U_SO_QP3 <> 0 ) AND (T1.U_SO_P3 IS NULL OR T1.U_SO_P3 = ''))
				OR ((T1.U_SO_QP4 IS NOT NULL AND T1.U_SO_QP4 <> 0 ) AND (T1.U_SO_P4 IS NULL OR T1.U_SO_P4 = ''))
				OR ((T1.U_SO_QP5 IS NOT NULL AND T1.U_SO_QP5 <> 0 ) AND (T1.U_SO_P5 IS NULL OR T1.U_SO_P5 = ''))
				OR ((T1.U_SO_QP6 IS NOT NULL AND T1.U_SO_QP6 <> 0 ) AND (T1.U_SO_P6 IS NULL OR T1.U_SO_P6 = ''))
				OR ((T1.U_SO_QP7 IS NOT NULL AND T1.U_SO_QP7 <> 0 ) AND (T1.U_SO_P7 IS NULL OR T1.U_SO_P7 = '')))	
	
			OR (((T1.U_SO_P1Prc IS NULL OR T1.U_SO_P1Prc = 0 ) AND (T1.U_SO_TP1 IS NOT NULL AND T1.U_SO_TP1 <> 0))
				OR ((T1.U_SO_P2Prc IS NULL OR T1.U_SO_P2Prc = 0 ) AND (T1.U_SO_TP2 IS NOT NULL AND T1.U_SO_TP2 <> 0))			
				OR ((T1.U_SO_P3Prc IS NULL OR T1.U_SO_P3Prc = 0 ) AND (T1.U_SO_TP3 IS NOT NULL AND T1.U_SO_TP3 <> 0))
				OR ((T1.U_SO_P4Prc IS NULL OR T1.U_SO_P4Prc = 0 ) AND (T1.U_SO_TP4 IS NOT NULL AND T1.U_SO_TP4 <> 0))
				OR ((T1.U_SO_P5Prc IS NULL OR T1.U_SO_P5Prc = 0 ) AND (T1.U_SO_TP5 IS NOT NULL AND T1.U_SO_TP5 <> 0))
				OR ((T1.U_SO_P6Prc IS NULL OR T1.U_SO_P6Prc = 0 ) AND (T1.U_SO_TP6 IS NOT NULL AND T1.U_SO_TP6 <> 0))
				OR ((T1.U_SO_P7Prc IS NULL OR T1.U_SO_P7Prc = 0 ) AND (T1.U_SO_TP7 IS NOT NULL AND T1.U_SO_TP7 <> 0)))
			
			OR (((T1.U_SO_P1Prc IS NOT NULL AND T1.U_SO_P1Prc <> 0 ) AND (T1.U_SO_TP1 IS NULL OR T1.U_SO_TP1 = 0))
				OR ((T1.U_SO_P2Prc IS NOT NULL AND T1.U_SO_P2Prc <> 0 ) AND (T1.U_SO_TP2 IS NULL OR T1.U_SO_TP2 = 0))			
				OR ((T1.U_SO_P3Prc IS NOT NULL AND T1.U_SO_P3Prc <> 0 ) AND (T1.U_SO_TP3 IS NULL OR T1.U_SO_TP3 = 0))
				OR ((T1.U_SO_P4Prc IS NOT NULL AND T1.U_SO_P4Prc <> 0 ) AND (T1.U_SO_TP4 IS NULL OR T1.U_SO_TP4 = 0))
				OR ((T1.U_SO_P5Prc IS NOT NULL AND T1.U_SO_P5Prc <> 0 ) AND (T1.U_SO_TP5 IS NULL OR T1.U_SO_TP5 = 0))
				OR ((T1.U_SO_P6Prc IS NOT NULL AND T1.U_SO_P6Prc <> 0 ) AND (T1.U_SO_TP6 IS NULL OR T1.U_SO_TP6 = 0))
				OR ((T1.U_SO_P7Prc IS NOT NULL AND T1.U_SO_P7Prc <> 0 ) AND (T1.U_SO_TP7 IS NULL OR T1.U_SO_TP7 = 0)))
			)

		IF @countRecord = 1			
		BEGIN -- CountRecord
			IF @WhsCode = 'FG-002' 
			BEGIN -- Warehouse Banding
-- Jika Quantity Tidak Diisi
				If @Quantity = 0 OR @Quantity IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Quantity!!! FG-002' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
-- Jika Price Tidak Diisi
--				ELSE If @Price = 0 OR @Price IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Unit Price!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
--				END
-- Jika Price Tidak Sama Dengan Total Job
-- Jika Kode Jenis Kaca Diisi	
				ELSE If @KodeJenisKaca <> '' AND @KodeJenisKaca IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? KODE JENIS KACA TEBAL TIDAK BOLEH DIISI!!! FG-002' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
-- Jika Jenis Kaca Diisi
				ELSE If @JenisKaca <> '' AND @JenisKaca IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JENIS KACA TIDAK BOLEH DIISI!!! FG-002' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END				
-- Jika Tebal Diisi				
				ELSE If @Tebal <> 0 AND @Tebal IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? TEBAL TIDAK BOLEH DIISI!!! FG-002' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END
-- Jika Warna Diisi
				ELSE If @Warna <> '' AND @Warna IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? WARNA TIDAK BOLEH DIISI!!! FG-002' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
-- Jika Keterangan Diisi
				ELSE If @Keterangan <> '' AND @Keterangan IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? KETERANGAN TIDAK BOLEH DIISI!!! FG-002' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 	
				END
				--ELSE If @Price <> @TotalALLRM
				--BEGIN
				--	SELECT @error = 1, 
				--		@error_message = 'NOT SUCESSFULLY???  Total Price Harus Sama Dengan TotalJob1 SAMPAI TotalJob7  FG-002 Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1) + ' Please Edit SO Price'
				--END
-- Jika Luas M2 Tidak Diisi
--				ELSE If @LUASM2 = 0 OR @LUASM2 IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Luas M2!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@LineNum + 1)		
--				END	
-- Jika Price M2 Diisi
				ELSE If @PriceM2 <> 0 AND @PriceM2 IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PriceM2 Tidak Boleh Diisi!!!  FG-002' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END
-- Jika Total RM Diisi
				ELSE If @TotalRM <> 0 AND @TotalRM IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Total RM Tidak Boleh Diisi!!!  FG-002' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END
-- Jika Job 01 sampai Job 07 tidak diisi maka eror
				ELSE If ((@Job01 IS NULL OR @Job01 = '') 
				AND (@Job02 IS NULL OR @Job02 = '')
				AND (@Job03 IS NULL OR @Job03 = '') 
				AND (@Job04 IS NULL OR @Job04 = '') 
				AND (@Job05 IS NULL OR @Job05 = '') 
				AND (@Job06 IS NULL OR @Job06 = '') 
				AND (@Job07 IS NULL OR @Job07 = ''))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT JOB !!!  FG-002' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END


-- Modified karno 24 mei 2010
				ELSE IF(@TotalCalRM <> @TotalRM)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total RM (LUASM2 * PriceM2)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob01 <> @TotalJob01)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 1 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob02 <> @TotalJob02)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 2 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob03 <> @TotalJob03)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 3 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob04 <> @TotalJob04)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 4 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob05 <> @TotalJob05)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 5 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob06 <> @TotalJob06)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 6 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob07 <> @TotalJob07)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 7 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END


-- Jika Kode Job diisi dan job Qty tidak diisi maka Job Qty wajib isi 

				ELSE IF((@Job01 <> '' AND @Job01 IS NOT NULL  ) AND (@JobQty01 IS NULL OR @JobQty01 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 01 DIISI, MAKA JOB QTY 01 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job02 <> ''  AND @Job02 IS NOT NULL ) AND (@JobQty02 IS NULL OR @JobQty02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 02 DIISI, MAKA JOB QTY 02 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job03 IS NOT NULL AND @Job03 <> '') AND (@JobQty03 IS NULL OR @JobQty03 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 03 DIISI, MAKA JOB QTY 03 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job04 IS NOT NULL AND @Job04 <> '') AND (@JobQty04 IS NULL OR @JobQty04 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 04 DIISI, MAKA JOB QTY 04 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job05 IS NOT NULL AND @Job05 <> '') AND (@JobQty05 IS NULL OR @JobQty05 = 0)) 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 05 DIISI, MAKA JOB QTY 05 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job06 IS NOT NULL AND @Job06 <> '') AND (@JobQty06 IS NULL OR @JobQty06 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 06 DIISI, MAKA JOB QTY 06 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job07 IS NOT NULL AND @Job07 <> '') AND (@JobQty07 IS NULL OR @JobQty07 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 07 DIISI, MAKA JOB QTY 07 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

-- Jika Job Qty diisi dan job01 tidak diisi maka Job01 wajib isi 
				ELSE IF((@Job01 IS NULL OR @Job01 = '') AND (@JobQty01 IS NOT NULL AND @JobQty01 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 01 DIISI, MAKA JOB 01 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END		
				ELSE IF((@Job02 IS NULL OR @Job02 = '') AND (@JobQty02 IS NOT NULL AND @JobQty02 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 02 DIISI, MAKA JOB 02 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job03 IS NULL OR @Job03 = '') AND (@JobQty03 IS NOT NULL AND @JobQty03 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 03 DIISI, MAKA JOB 03 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job04 IS NULL OR @Job04 = '') AND (@JobQty04 IS NOT NULL AND @JobQty04 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 04 DIISI, MAKA JOB 04 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job05 IS NULL OR @Job05 = '') AND (@JobQty05 IS NOT NULL AND @JobQty05 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 05 DIISI, MAKA JOB 05 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job06 IS NULL OR @Job06 = '') AND (@JobQty06 IS NOT NULL AND @JobQty06 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 06 DIISI, MAKA JOB 06 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job07 IS NULL OR @Job07 = '') AND (@JobQty07 IS NOT NULL AND @JobQty07 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 07 DIISI, MAKA JOB 07 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END		

-- Jika Total Job diisi dan job RP tidak diisi maka Job RP wajib isi 

				ELSE IF((@JobRP01 = 0 OR @JobRP01 IS NULL  ) AND (@TotalJob01 IS NOT NULL AND @TotalJob01 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 01 DIISI, MAKA JOB RP 01 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP02 = 0 OR @JobRP02 IS NULL  ) AND (@TotalJob02 IS NOT NULL AND @TotalJob02 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 02 DIISI, MAKA JOB RP 02 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP03 = 0 OR @JobRP03 IS NULL  ) AND (@TotalJob03 IS NOT NULL AND @TotalJob03 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 03 DIISI, MAKA JOB RP 03 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP04 = 0 OR @JobRP04 IS NULL  ) AND (@TotalJob04 IS NOT NULL AND @TotalJob04 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 04 DIISI, MAKA JOB RP 04 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP05 = 0 OR @JobRP05 IS NULL  ) AND (@TotalJob05 IS NOT NULL AND @TotalJob05 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 05 DIISI, MAKA JOB RP 05 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP06 = 0 OR @JobRP06 IS NULL  ) AND (@TotalJob06 IS NOT NULL AND @TotalJob06 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 06 DIISI, MAKA JOB RP 06 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP07 = 0 OR @JobRP07 IS NULL  ) AND (@TotalJob07 IS NOT NULL AND @TotalJob07 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 07 DIISI, MAKA JOB RP 07 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

-- Jika Job RP diisi dan Total job tidak diisi maka Job RP wajib isi 

				ELSE IF((@JobRP01 <> 0 AND @JobRP01 IS NOT NULL  ) AND (@TotalJob01 IS NULL OR @TotalJob01 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 01 DIISI, MAKA TOTAL JOB 01 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP02 <> 0 AND @JobRP02 IS NOT NULL  ) AND (@TotalJob02 IS NULL OR @TotalJob02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 02 DIISI, MAKA TOTAL JOB 02 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP03 <> 0 AND @JobRP03 IS NOT NULL  ) AND (@TotalJob03 IS NULL OR @TotalJob02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 03 DIISI, MAKA TOTAL JOB 03 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP04 <> 0 AND @JobRP04 IS NOT NULL  ) AND (@TotalJob04 IS NULL OR @TotalJob04 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 04 DIISI, MAKA TOTAL JOB 04 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@JobRP05 <> 0 AND @JobRP05 IS NOT NULL  ) AND (@TotalJob05 IS NULL OR @TotalJob05 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 05 DIISI, MAKA TOTAL JOB 05 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP06 <> 0 AND @JobRP06 IS NOT NULL  ) AND (@TotalJob06 IS NULL OR @TotalJob06 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 06 DIISI, MAKA TOTAL JOB 06 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP07 <> 0 AND @JobRP07 IS NOT NULL  ) AND (@TotalJob07 IS NULL OR @TotalJob07 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 07 DIISI, MAKA TOTAL JOB 07 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
			END -- Warehouse Banding
		End -- Count Record
	
-- TESTING 3
---------------------------------------------------------------------------------------------------
--  AWAL --- JIKA Warehouse Bukan FG-001 Dan FG-002 ---
---------------------------------------------------------------------------------------------------
--else IF @WhsCode <> 'FG-001' AND @WhsCode <> 'FG-002'
--BEGIN -- Warehouse And Item
SET @countRecord = 0
		select TOP 1
		@LineNum = LineNum,
		@WhsCode = WhsCode,
		@ItemCode = ItemCode,
		@Quantity = Quantity,
		@Price = Price,
		@PriceM2 = U_SO_PrcM2,
--		@TotalRM = ROUND(U_SO_TRM,2),
--		@TotalCalRM = ROUND(ROUND(U_SO_LUASM2,4) * ROUND(U_SO_PrcM2,2),2),
		@countRecord = 1
		FROM DLN1 T1
		JOIN ODLN T0
		ON T1.DOCENTRY = T0.DOCENTRY
		WHERE T1.DOCENTRY = CAST(@list_of_cols_val_tab_del AS INT)
			AND DOCTYPE = 'I'
			AND WhsCode <> 'FG-001' AND WhsCode <> 'FG-002'
			AND 
			(	
			(T1.Quantity IS NULL OR T1.Quantity = 0) OR			
			(T1.Price IS NULL OR T1.Price = 0) OR
			(T1.U_SO_PrcM2 IS NOT NULL AND T1.U_SO_PrcM2 <> 0) OR
			(T1.U_SO_TRM IS NOT NULL AND T1.U_SO_TRM <> 0)
			)
		IF @countRecord = 1			
		BEGIN -- Count Record
			IF @WhsCode <> 'FG-001' AND @WhsCode <> 'FG-002'
			BEGIN -- Warehouse Banding
-- Jika Quantity Tidak Diisi
				If @Quantity = 0 OR @Quantity IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Quantity!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
-- Jika Price Tidak Diisi
				ELSE If @Price = 0 OR @Price IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Unit Price!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
-- Jika Price M2 Diisi
				ELSE If @PriceM2 <> 0 AND @PriceM2 IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PriceM2 Tidak Boleh Diisi!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END
-- Jika Total RM Diisi
				ELSE If @TotalRM <> 0 AND @TotalRM IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Total RM Tidak Boleh Diisi!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END
	
			END --Warehouse Banding
		END -- CountRecord
-----------------------------------------------------------------------------------------------------
----  AKHIR --- JIKA Warehouse BUKAN FG-001 DAN FG-002 ---
-----------------------------------------------------------------------------------------------------
END -- Object Type

-- 20100423 by Toin
-- Select the return values
--select @error, @error_message


---### #   ### ### # #   ####  ####  -------------------------------------------------------------------------------------------
---# # #   # # #   ##    #     #  #  -------------------------------------------------------------------------------------------
---### #   # # #   #     ####  #  #  -----------------------------------------------------------------------------------------
---# # #   # # #   ##       #  #  #  ------------------------------------------------------------------------------------------
---### ### ### ### # #   ####  ####  -------------------------------------------------------------------------------------------

-- BLOCKING SALES ORDER
	IF  (@object_type = N'17')
	AND (@transaction_type = 'A' OR @transaction_type = 'U')
	BEGIN 
--
--SET @countRecord = 0
--	SELECT TOP 1 @countRecord = 1,
--		@WhsCode = WhsCode, @ItemCode = ItemCode
--		FROM RDR1 T1
--		JOIN ORDR T0
--		ON T1.DOCENTRY = T0.DOCENTRY
--		WHERE T1.DOCENTRY = CAST(@list_of_cols_val_tab_del AS INT)
--			AND DOCTYPE = 'I'	
--
--IF @CountRecord > 0
--BEGIN
----------------------------------------------------------------------------------------------------------------
--  AWAL --- JIKA Warehouse FG-001 Dengan kondisi Penjualan Kaca Dan Jasa, ItemCode Tidak Diawali dengan CS ---
----------------------------------------------------------------------------------------------------------------
--IF @WhsCode = 'FG-001' AND @ItemCode NOT Like 'CS%'
--BEGIN
SET @countRecord = 0
		select TOP 1
		@VisOrder = VisOrder,
		@LineNum = LineNum,
		@WhsCode = WhsCode,
		@ItemCode = ItemCode,
		@Quantity = Quantity,
		@Price = Price,
		@KodeJenisKaca = U_MIS_JNSKACATEB,
		@JenisKaca = U_MIS_JenisKaca,
		@Tebal = U_MIS_Tebal,
		@Warna = U_MIS_Warna,
		@Keterangan = U_MIS_Desc,		
		@LUASM2 = U_SO_LUASM2,
		@PriceM2 = U_SO_PrcM2,
		@QtyLbr = U_MIS_QtyLbr,
		@TotalRM = ROUND(U_SO_TRM,2),
		@TotalCalRM = ROUND(ROUND(U_SO_LUASM2,4) * ROUND(U_SO_PrcM2,4),2),
-- jika total Job tidak sama dengan Qty * Price
		@TotalCalJob01 = ROUND(ROUND(U_SO_QP1,4) * ROUND(U_SO_P1Prc,4),4),
		@TotalCalJob02 = ROUND(ROUND(U_SO_QP2,4) * ROUND(U_SO_P2Prc,4),4),
		@TotalCalJob03 = ROUND(ROUND(U_SO_QP3,4) * ROUND(U_SO_P3Prc,4),4),
		@TotalCalJob04 = ROUND(ROUND(U_SO_QP4,4) * ROUND(U_SO_P4Prc,4),4),
		@TotalCalJob05 = ROUND(ROUND(U_SO_QP5,4) * ROUND(U_SO_P5Prc,4),4),
		@TotalCalJob06 = ROUND(ROUND(U_SO_QP6,4) * ROUND(U_SO_P6Prc,4),4),
		@TotalCalJob07 = ROUND(ROUND(U_SO_QP7,4) * ROUND(U_SO_P7Prc,4),4),		
		@Job01 = U_SO_P1, @JobQty01 = U_SO_QP1, @JobRp01 = U_SO_P1Prc, @TotalJob01 = ROUND(U_SO_TP1,4),
		@Job02 = U_SO_P2, @JobQty02 = U_SO_QP2, @JobRp02 = U_SO_P2Prc, @TotalJob02 = ROUND(U_SO_TP2,4),
		@Job03 = U_SO_P3, @JobQty03 = U_SO_QP3, @JobRp03 = U_SO_P3Prc, @TotalJob03 = ROUND(U_SO_TP3,4),
		@Job04 = U_SO_P4, @JobQty04 = U_SO_QP4, @JobRp04 = U_SO_P4Prc, @TotalJob04 = ROUND(U_SO_TP4,4),
		@Job05 = U_SO_P5, @JobQty05 = U_SO_QP5, @JobRp05 = U_SO_P5Prc, @TotalJob05 = ROUND(U_SO_TP5,4),
		@Job06 = U_SO_P6, @JobQty06 = U_SO_QP6, @JobRp06 = U_SO_P6Prc, @TotalJob06 = ROUND(U_SO_TP6,4),
		@Job07 = U_SO_P7, @JobQty07 = U_SO_QP7, @JobRp07 = U_SO_P7Prc, @TotalJob07 = ROUND(U_SO_TP7,4),
		@countRecord = 1
		FROM RDR1 T1
		JOIN ORDR T0
		ON T1.DOCENTRY = T0.DOCENTRY
		WHERE T1.DOCENTRY = CAST(@list_of_cols_val_tab_del AS INT)
			AND DOCTYPE = 'I'
			AND WhsCode = 'FG-001' AND ItemCode NOT Like 'CS%'
			AND 
			(	
			(T1.Quantity IS NULL OR T1.Quantity = 0)
--			OR (T1.Price IS NULL OR T1.Price = 0)
			OR (T1.U_MIS_JNSKACATEB IS NULL OR T1.U_MIS_JNSKACATEB = '')
			OR (T1.U_MIS_JenisKaca IS NULL OR T1.U_MIS_JenisKaca= '')
			OR (T1.U_MIS_Tebal IS NULL OR T1.U_MIS_Tebal= 0)
			OR (T1.U_MIS_Warna IS NULL OR T1.U_MIS_Warna= '')
			OR (T1.U_MIS_Desc IS NULL OR T1.U_MIS_Desc= '')
			OR (T1.U_SO_LUASM2 IS NULL OR T1.U_SO_LUASM2 = 0)
--			OR (T1.U_SO_PrcM2 IS NULL OR T1.U_SO_PrcM2 = 0)
--			OR (T1.U_SO_TRM IS NULL OR T1.U_SO_TRM = 0)
-- karno
			OR (ROUND(T1.U_SO_TRM,2) <> Round(Round(U_SO_LUASM2,4) * round(U_SO_PrcM2,4),2))

			OR (ROUND(U_SO_TP1,4) <> Round(ROUND(U_SO_QP1,4) * ROUND(U_SO_P1Prc,4),4))
			OR (ROUND(U_SO_TP2,4) <> Round(ROUND(U_SO_QP2,4) * ROUND(U_SO_P2Prc,4),4))
			OR (ROUND(U_SO_TP3,4) <> Round(ROUND(U_SO_QP3,4) * ROUND(U_SO_P3Prc,4),4))
			OR (ROUND(U_SO_TP4,4) <> Round(ROUND(U_SO_QP4,4) * ROUND(U_SO_P4Prc,4),4))
			OR (ROUND(U_SO_TP5,4) <> Round(ROUND(U_SO_QP5,4) * ROUND(U_SO_P5Prc,4),4))
			OR (ROUND(U_SO_TP6,4) <> Round(ROUND(U_SO_QP6,4) * ROUND(U_SO_P6Prc,4),4))
			OR (ROUND(U_SO_TP7,4) <> Round(ROUND(U_SO_QP7,4) * ROUND(U_SO_P7Prc,4),4))

--			OR ((T1.U_SO_P1 IS NULL OR T1.U_SO_P1 = '') 
--				AND (T1.U_SO_P2 IS NULL OR T1.U_SO_P2 = '')
--				AND (T1.U_SO_P3 IS NULL OR T1.U_SO_P3 = '') 
--				AND (T1.U_SO_P4 IS NULL OR T1.U_SO_P4 = '') 
--				AND (T1.U_SO_P5 IS NULL OR T1.U_SO_P5 = '') 
--				AND (T1.U_SO_P6 IS NULL OR T1.U_SO_P6 = '') 
--				AND (T1.U_SO_P7 IS NULL OR T1.U_SO_P7 = ''))
			OR (((T1.U_SO_QP1 IS NULL OR T1.U_SO_QP1 = 0 ) AND (T1.U_SO_P1 IS NOT NULL AND T1.U_SO_P1 <> ''))
				OR ((T1.U_SO_QP2 IS NULL OR T1.U_SO_QP2 = 0 ) AND (T1.U_SO_P2 IS NOT NULL AND T1.U_SO_P2 <> ''))			
				OR ((T1.U_SO_QP3 IS NULL OR T1.U_SO_QP3 = 0 ) AND (T1.U_SO_P3 IS NOT NULL AND T1.U_SO_P3 <> ''))
				OR ((T1.U_SO_QP4 IS NULL OR T1.U_SO_QP4 = 0 ) AND (T1.U_SO_P4 IS NOT NULL AND T1.U_SO_P4 <> ''))
				OR ((T1.U_SO_QP5 IS NULL OR T1.U_SO_QP5 = 0 ) AND (T1.U_SO_P5 IS NOT NULL AND T1.U_SO_P5 <> ''))
				OR ((T1.U_SO_QP6 IS NULL OR T1.U_SO_QP6 = 0 ) AND (T1.U_SO_P6 IS NOT NULL AND T1.U_SO_P6 <> ''))
				OR ((T1.U_SO_QP7 IS NULL OR T1.U_SO_QP7 = 0 ) AND (T1.U_SO_P7 IS NOT NULL AND T1.U_SO_P7 <> '')))
			OR (((T1.U_SO_QP1 IS NOT NULL AND T1.U_SO_QP1 <> 0 ) AND (T1.U_SO_P1 IS NULL OR T1.U_SO_P1 = ''))
				OR ((T1.U_SO_QP2 IS NOT NULL AND T1.U_SO_QP2 <> 0 ) AND (T1.U_SO_P2 IS NULL OR T1.U_SO_P2 = ''))			
				OR ((T1.U_SO_QP3 IS NOT NULL AND T1.U_SO_QP3 <> 0 ) AND (T1.U_SO_P3 IS NULL OR T1.U_SO_P3 = ''))
				OR ((T1.U_SO_QP4 IS NOT NULL AND T1.U_SO_QP4 <> 0 ) AND (T1.U_SO_P4 IS NULL OR T1.U_SO_P4 = ''))
				OR ((T1.U_SO_QP5 IS NOT NULL AND T1.U_SO_QP5 <> 0 ) AND (T1.U_SO_P5 IS NULL OR T1.U_SO_P5 = ''))
				OR ((T1.U_SO_QP6 IS NOT NULL AND T1.U_SO_QP6 <> 0 ) AND (T1.U_SO_P6 IS NULL OR T1.U_SO_P6 = ''))
				OR ((T1.U_SO_QP7 IS NOT NULL AND T1.U_SO_QP7 <> 0 ) AND (T1.U_SO_P7 IS NULL OR T1.U_SO_P7 = '')))	
	
			OR (((T1.U_SO_P1Prc IS NULL OR T1.U_SO_P1Prc = 0 ) AND (T1.U_SO_TP1 IS NOT NULL AND T1.U_SO_TP1 <> 0))
				OR ((T1.U_SO_P2Prc IS NULL OR T1.U_SO_P2Prc = 0 ) AND (T1.U_SO_TP2 IS NOT NULL AND T1.U_SO_TP2 <> 0))			
				OR ((T1.U_SO_P3Prc IS NULL OR T1.U_SO_P3Prc = 0 ) AND (T1.U_SO_TP3 IS NOT NULL AND T1.U_SO_TP3 <> 0))
				OR ((T1.U_SO_P4Prc IS NULL OR T1.U_SO_P4Prc = 0 ) AND (T1.U_SO_TP4 IS NOT NULL AND T1.U_SO_TP4 <> 0))
				OR ((T1.U_SO_P5Prc IS NULL OR T1.U_SO_P5Prc = 0 ) AND (T1.U_SO_TP5 IS NOT NULL AND T1.U_SO_TP5 <> 0))
				OR ((T1.U_SO_P6Prc IS NULL OR T1.U_SO_P6Prc = 0 ) AND (T1.U_SO_TP6 IS NOT NULL AND T1.U_SO_TP6 <> 0))
				OR ((T1.U_SO_P7Prc IS NULL OR T1.U_SO_P7Prc = 0 ) AND (T1.U_SO_TP7 IS NOT NULL AND T1.U_SO_TP7 <> 0)))
						
			OR (((T1.U_SO_P1Prc IS NOT NULL AND T1.U_SO_P1Prc <> 0 ) AND (T1.U_SO_TP1 IS NULL OR T1.U_SO_TP1 = 0))
				OR ((T1.U_SO_P2Prc IS NOT NULL AND T1.U_SO_P2Prc <> 0 ) AND (T1.U_SO_TP2 IS NULL OR T1.U_SO_TP2 = 0))			
				OR ((T1.U_SO_P3Prc IS NOT NULL AND T1.U_SO_P3Prc <> 0 ) AND (T1.U_SO_TP3 IS NULL OR T1.U_SO_TP3 = 0))
				OR ((T1.U_SO_P4Prc IS NOT NULL AND T1.U_SO_P4Prc <> 0 ) AND (T1.U_SO_TP4 IS NULL OR T1.U_SO_TP4 = 0))
				OR ((T1.U_SO_P5Prc IS NOT NULL AND T1.U_SO_P5Prc <> 0 ) AND (T1.U_SO_TP5 IS NULL OR T1.U_SO_TP5 = 0))
				OR ((T1.U_SO_P6Prc IS NOT NULL AND T1.U_SO_P6Prc <> 0 ) AND (T1.U_SO_TP6 IS NULL OR T1.U_SO_TP6 = 0))
				OR ((T1.U_SO_P7Prc IS NOT NULL AND T1.U_SO_P7Prc <> 0 ) AND (T1.U_SO_TP7 IS NULL OR T1.U_SO_TP7 = 0)))
			)

		IF @countRecord = 1			
		BEGIN
			IF @WhsCode = 'FG-001' AND @ItemCode NOT Like 'CS%'
			BEGIN
				If @Quantity = 0 OR @Quantity IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Quantity!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

--				ELSE If @Price = 0 OR @Price IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Unit Price!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
--				END
	-- KArno
				ELSE If @KodeJenisKaca = '' OR @KodeJenisKaca IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT KODE JENIS KACA TEBAL!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE If @JenisKaca = '' OR @JenisKaca IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT JENIS KACA !!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END				
				
				ELSE If @Tebal = 0 OR @Tebal IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT TEBAL!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END

				ELSE If @Warna = '' OR @Warna IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT WARNA!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE If @Keterangan = '' OR @Keterangan IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT KETERANGAN!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 	
				END
			
				ELSE If @LUASM2 = 0 OR @LUASM2 IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Luas M2!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END	

--				ELSE If @PriceM2 = 0 OR @PriceM2 IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Price M2!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
--				END	

-- Karena ada kasus tertentu dimana total RM tidak diisi mis 1 set pintu
--				ELSE If @TotalRM = 0 OR @TotalRM IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Total Raw Material!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
--				END	

-- Jika Job 01 sampai Job 07 tidak diisi maka eror
--				ELSE If ((@Job01 IS NULL OR @Job01 = '') 
--				AND (@Job02 IS NULL OR @Job02 = '')
--				AND (@Job03 IS NULL OR @Job03 = '') 
--				AND (@Job04 IS NULL OR @Job04 = '') 
--				AND (@Job05 IS NULL OR @Job05 = '') 
--				AND (@Job06 IS NULL OR @Job06 = '') 
--				AND (@Job07 IS NULL OR @Job07 = ''))
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT JOB !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
--				END

-- Modified karno 24 mei 2010
				ELSE IF(@TotalCalRM <> @TotalRM)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY???  Check Total RM (LUASM2 * PriceM2)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

-- Jika Total Job tidak Sama Dengan Qty Job * RP Job
				ELSE IF(@TotalCalJob01 <> @TotalJob01)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 1 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob02 <> @TotalJob02)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 2 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob03 <> @TotalJob03)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 3 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob04 <> @TotalJob04)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 4 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob05 <> @TotalJob05)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 5 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob06 <> @TotalJob06)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 6 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob07 <> @TotalJob07)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 7 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

-- Jika Kode Job diisi dan job Qty tidak diisi maka Job Qty wajib isi 

				ELSE IF((@Job01 <> '' AND @Job01 IS NOT NULL  ) AND (@JobQty01 IS NULL OR @JobQty01 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 01 DIISI, MAKA JOB QTY 01 HARUS DIISI !!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job02 <> ''  AND @Job02 IS NOT NULL ) AND (@JobQty02 IS NULL OR @JobQty02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 02 DIISI, MAKA JOB QTY 02 HARUS DIISI !!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job03 IS NOT NULL AND @Job03 <> '') AND (@JobQty03 IS NULL OR @JobQty03 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 03 DIISI, MAKA JOB QTY 03 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job04 IS NOT NULL AND @Job04 <> '') AND (@JobQty04 IS NULL OR @JobQty04 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 04 DIISI, MAKA JOB QTY 04 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job05 IS NOT NULL AND @Job05 <> '') AND (@JobQty05 IS NULL OR @JobQty05 = 0)) 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 05 DIISI, MAKA JOB QTY 05 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job06 IS NOT NULL AND @Job06 <> '') AND (@JobQty06 IS NULL OR @JobQty06 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 06 DIISI, MAKA JOB QTY 06 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job07 IS NOT NULL AND @Job07 <> '') AND (@JobQty07 IS NULL OR @JobQty07 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 07 DIISI, MAKA JOB QTY 07 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

-- Jika Job Qty diisi dan job01 tidak diisi maka Job01 wajib isi 
				ELSE IF((@Job01 IS NULL OR @Job01 = '') AND (@JobQty01 IS NOT NULL AND @JobQty01 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 01 DIISI, MAKA JOB 01 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END		
				ELSE IF((@Job02 IS NULL OR @Job02 = '') AND (@JobQty02 IS NOT NULL AND @JobQty02 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 02 DIISI, MAKA JOB 02 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job03 IS NULL OR @Job03 = '') AND (@JobQty03 IS NOT NULL AND @JobQty03 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 03 DIISI, MAKA JOB 03 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job04 IS NULL OR @Job04 = '') AND (@JobQty04 IS NOT NULL AND @JobQty04 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 04 DIISI, MAKA JOB 04 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job05 IS NULL OR @Job05 = '') AND (@JobQty05 IS NOT NULL AND @JobQty05 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 05 DIISI, MAKA JOB 05 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job06 IS NULL OR @Job06 = '') AND (@JobQty06 IS NOT NULL AND @JobQty06 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 06 DIISI, MAKA JOB 06 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job07 IS NULL OR @Job07 = '') AND (@JobQty07 IS NOT NULL AND @JobQty07 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 07 DIISI, MAKA JOB 07 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END		

-- Jika Total Job diisi dan job RP tidak diisi maka Job RP wajib isi 

				ELSE IF((@JobRP01 = 0 OR @JobRP01 IS NULL  ) AND (@TotalJob01 IS NOT NULL AND @TotalJob01 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 01 DIISI, MAKA JOB RP 01 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP02 = 0 OR @JobRP02 IS NULL  ) AND (@TotalJob02 IS NOT NULL AND @TotalJob02 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 02 DIISI, MAKA JOB RP 02 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP03 = 0 OR @JobRP03 IS NULL  ) AND (@TotalJob03 IS NOT NULL AND @TotalJob03 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 03 DIISI, MAKA JOB RP 03 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP04 = 0 OR @JobRP04 IS NULL  ) AND (@TotalJob04 IS NOT NULL AND @TotalJob04 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 04 DIISI, MAKA JOB RP 04 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP05 = 0 OR @JobRP05 IS NULL  ) AND (@TotalJob05 IS NOT NULL AND @TotalJob05 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 05 DIISI, MAKA JOB RP 05 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP06 = 0 OR @JobRP06 IS NULL  ) AND (@TotalJob06 IS NOT NULL AND @TotalJob06 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 06 DIISI, MAKA JOB RP 06 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP07 = 0 OR @JobRP07 IS NULL  ) AND (@TotalJob07 IS NOT NULL AND @TotalJob07 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 07 DIISI, MAKA JOB RP 07 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

-- Jika Job RP diisi dan Total job tidak diisi maka Job RP wajib isi 

				ELSE IF((@JobRP01 <> 0 AND @JobRP01 IS NOT NULL  ) AND (@TotalJob01 IS NULL OR @TotalJob01 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 01 DIISI, MAKA TOTAL JOB 01 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP02 <> 0 AND @JobRP02 IS NOT NULL  ) AND (@TotalJob02 IS NULL OR @TotalJob02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 02 DIISI, MAKA TOTAL JOB 02 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP03 <> 0 AND @JobRP03 IS NOT NULL  ) AND (@TotalJob03 IS NULL OR @TotalJob02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 03 DIISI, MAKA TOTAL JOB 03 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP04 <> 0 AND @JobRP04 IS NOT NULL  ) AND (@TotalJob04 IS NULL OR @TotalJob04 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 04 DIISI, MAKA TOTAL JOB 04 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@JobRP05 <> 0 AND @JobRP05 IS NOT NULL  ) AND (@TotalJob05 IS NULL OR @TotalJob05 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 05 DIISI, MAKA TOTAL JOB 05 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP06 <> 0 AND @JobRP06 IS NOT NULL  ) AND (@TotalJob06 IS NULL OR @TotalJob06 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 06 DIISI, MAKA TOTAL JOB 06 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP07 <> 0 AND @JobRP07 IS NOT NULL  ) AND (@TotalJob07 IS NULL OR @TotalJob07 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 07 DIISI, MAKA TOTAL JOB 07 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
			
			END -- Warehouse
		END -- Count Record
	
----------------------------------------------------------------------------------------------------------------
--  AKHIR --- JIKA Warehouse FG-001 Dengan kondisi Penjualan Kaca Dan Jasa, ItemCode Tidak Diawali dengan CS ---
----------------------------------------------------------------------------------------------------------------

---------------------------------------------------------------------------------------------------
--  AWAL --- JIKA Warehouse FG-001 Dengan kondisi Penjualan Kaca Dan ItemCode Diawali dengan CS ---
---------------------------------------------------------------------------------------------------
--else IF @WhsCode = 'FG-001' AND @ItemCode Like 'CS%'
--BEGIN
SET @countRecord = 0
		select TOP 1
		@VisOrder = VisOrder,
		@LineNum = LineNum,
		@WhsCode = WhsCode,
		@ItemCode = ItemCode,
		@Quantity = Quantity,
		@Price = Price,
		@KodeJenisKaca = U_MIS_JNSKACATEB,
		@JenisKaca = U_MIS_JenisKaca,
		@Tebal = U_MIS_Tebal,
		@Warna = U_MIS_Warna,
		@Keterangan = U_MIS_Desc,		
		@LUASM2 = U_SO_LUASM2,
		@PriceM2 = U_SO_PrcM2,
		@QtyLbr = U_MIS_QtyLbr,
		@TotalRM = ROUND(U_SO_TRM,2),
		@TotalCalRM = ROUND(ROUND(U_SO_LUASM2,4) * ROUND(U_SO_PrcM2,4),2),
-- jika total Job tidak sama dengan Qty * Price
		@TotalCalJob01 = ROUND(ROUND(U_SO_QP1,4) * ROUND(U_SO_P1Prc,4),4),
		@TotalCalJob02 = ROUND(ROUND(U_SO_QP2,4) * ROUND(U_SO_P2Prc,4),4),
		@TotalCalJob03 = ROUND(ROUND(U_SO_QP3,4) * ROUND(U_SO_P3Prc,4),4),
		@TotalCalJob04 = ROUND(ROUND(U_SO_QP4,4) * ROUND(U_SO_P4Prc,4),4),
		@TotalCalJob05 = ROUND(ROUND(U_SO_QP5,4) * ROUND(U_SO_P5Prc,4),4),
		@TotalCalJob06 = ROUND(ROUND(U_SO_QP6,4) * ROUND(U_SO_P6Prc,4),4),
		@TotalCalJob07 = ROUND(ROUND(U_SO_QP7,4) * ROUND(U_SO_P7Prc,4),4),		
		@Job01 = U_SO_P1, @JobQty01 = U_SO_QP1, @JobRp01 = U_SO_P1Prc, @TotalJob01 = ROUND(U_SO_TP1,4),
		@Job02 = U_SO_P2, @JobQty02 = U_SO_QP2, @JobRp02 = U_SO_P2Prc, @TotalJob02 = ROUND(U_SO_TP2,4),
		@Job03 = U_SO_P3, @JobQty03 = U_SO_QP3, @JobRp03 = U_SO_P3Prc, @TotalJob03 = ROUND(U_SO_TP3,4),
		@Job04 = U_SO_P4, @JobQty04 = U_SO_QP4, @JobRp04 = U_SO_P4Prc, @TotalJob04 = ROUND(U_SO_TP4,4),
		@Job05 = U_SO_P5, @JobQty05 = U_SO_QP5, @JobRp05 = U_SO_P5Prc, @TotalJob05 = ROUND(U_SO_TP5,4),
		@Job06 = U_SO_P6, @JobQty06 = U_SO_QP6, @JobRp06 = U_SO_P6Prc, @TotalJob06 = ROUND(U_SO_TP6,4),
		@Job07 = U_SO_P7, @JobQty07 = U_SO_QP7, @JobRp07 = U_SO_P7Prc, @TotalJob07 = ROUND(U_SO_TP7,4),
		@countRecord = 1
		FROM RDR1 T1
		JOIN ORDR T0
		ON T1.DOCENTRY = T0.DOCENTRY
		WHERE T1.DOCENTRY = CAST(@list_of_cols_val_tab_del AS INT)
			AND DOCTYPE = 'I'
			AND WhsCode = 'FG-001' AND ItemCode Like 'CS%'
			AND 
			(	
			(T1.Quantity IS NULL OR T1.Quantity = 0) OR			
--			(T1.Price IS NULL OR T1.Price = 0) OR
			(T1.U_MIS_JNSKACATEB IS NULL OR T1.U_MIS_JNSKACATEB = '') OR
			(T1.U_MIS_JenisKaca IS NULL OR T1.U_MIS_JenisKaca= '') OR
			(T1.U_MIS_Tebal IS NULL OR T1.U_MIS_Tebal= 0) OR
			(T1.U_MIS_Warna IS NULL OR T1.U_MIS_Warna= '') OR
			(T1.U_MIS_Desc IS NULL OR T1.U_MIS_Desc= '') OR			
			(T1.U_SO_LUASM2 IS NULL OR T1.U_SO_LUASM2 = 0)
-- karno
-- Diround jadi 0 karena ada penjualan yang berdasarkan lembar
			OR (ROUND(T1.U_SO_TRM,2) <> Round(Round(U_SO_LUASM2,4) * round(U_SO_PrcM2,4),2))


			OR (ROUND(U_SO_TP1,4) <> Round(ROUND(U_SO_QP1,4) * ROUND(U_SO_P1Prc,4),4))
			OR (ROUND(U_SO_TP2,4) <> Round(ROUND(U_SO_QP2,4) * ROUND(U_SO_P2Prc,4),4))
			OR (ROUND(U_SO_TP3,4) <> Round(ROUND(U_SO_QP3,4) * ROUND(U_SO_P3Prc,4),4))
			OR (ROUND(U_SO_TP4,4) <> Round(ROUND(U_SO_QP4,4) * ROUND(U_SO_P4Prc,4),4))
			OR (ROUND(U_SO_TP5,4) <> Round(ROUND(U_SO_QP5,4) * ROUND(U_SO_P5Prc,4),4))
			OR (ROUND(U_SO_TP6,4) <> Round(ROUND(U_SO_QP6,4) * ROUND(U_SO_P6Prc,4),4))
			OR (ROUND(U_SO_TP7,4) <> Round(ROUND(U_SO_QP7,4) * ROUND(U_SO_P7Prc,4),4))
			OR (((T1.U_SO_QP1 IS NULL OR T1.U_SO_QP1 = 0 ) AND (T1.U_SO_P1 IS NOT NULL AND T1.U_SO_P1 <> ''))
				OR ((T1.U_SO_QP2 IS NULL OR T1.U_SO_QP2 = 0 ) AND (T1.U_SO_P2 IS NOT NULL AND T1.U_SO_P2 <> ''))			
				OR ((T1.U_SO_QP3 IS NULL OR T1.U_SO_QP3 = 0 ) AND (T1.U_SO_P3 IS NOT NULL AND T1.U_SO_P3 <> ''))
				OR ((T1.U_SO_QP4 IS NULL OR T1.U_SO_QP4 = 0 ) AND (T1.U_SO_P4 IS NOT NULL AND T1.U_SO_P4 <> ''))
				OR ((T1.U_SO_QP5 IS NULL OR T1.U_SO_QP5 = 0 ) AND (T1.U_SO_P5 IS NOT NULL AND T1.U_SO_P5 <> ''))
				OR ((T1.U_SO_QP6 IS NULL OR T1.U_SO_QP6 = 0 ) AND (T1.U_SO_P6 IS NOT NULL AND T1.U_SO_P6 <> ''))
				OR ((T1.U_SO_QP7 IS NULL OR T1.U_SO_QP7 = 0 ) AND (T1.U_SO_P7 IS NOT NULL AND T1.U_SO_P7 <> '')))
			OR (((T1.U_SO_QP1 IS NOT NULL AND T1.U_SO_QP1 <> 0 ) AND (T1.U_SO_P1 IS NULL OR T1.U_SO_P1 = ''))
				OR ((T1.U_SO_QP2 IS NOT NULL AND T1.U_SO_QP2 <> 0 ) AND (T1.U_SO_P2 IS NULL OR T1.U_SO_P2 = ''))			
				OR ((T1.U_SO_QP3 IS NOT NULL AND T1.U_SO_QP3 <> 0 ) AND (T1.U_SO_P3 IS NULL OR T1.U_SO_P3 = ''))
				OR ((T1.U_SO_QP4 IS NOT NULL AND T1.U_SO_QP4 <> 0 ) AND (T1.U_SO_P4 IS NULL OR T1.U_SO_P4 = ''))
				OR ((T1.U_SO_QP5 IS NOT NULL AND T1.U_SO_QP5 <> 0 ) AND (T1.U_SO_P5 IS NULL OR T1.U_SO_P5 = ''))
				OR ((T1.U_SO_QP6 IS NOT NULL AND T1.U_SO_QP6 <> 0 ) AND (T1.U_SO_P6 IS NULL OR T1.U_SO_P6 = ''))
				OR ((T1.U_SO_QP7 IS NOT NULL AND T1.U_SO_QP7 <> 0 ) AND (T1.U_SO_P7 IS NULL OR T1.U_SO_P7 = '')))	
	
			OR (((T1.U_SO_P1Prc IS NULL OR T1.U_SO_P1Prc = 0 ) AND (T1.U_SO_TP1 IS NOT NULL AND T1.U_SO_TP1 <> 0))
				OR ((T1.U_SO_P2Prc IS NULL OR T1.U_SO_P2Prc = 0 ) AND (T1.U_SO_TP2 IS NOT NULL AND T1.U_SO_TP2 <> 0))			
				OR ((T1.U_SO_P3Prc IS NULL OR T1.U_SO_P3Prc = 0 ) AND (T1.U_SO_TP3 IS NOT NULL AND T1.U_SO_TP3 <> 0))
				OR ((T1.U_SO_P4Prc IS NULL OR T1.U_SO_P4Prc = 0 ) AND (T1.U_SO_TP4 IS NOT NULL AND T1.U_SO_TP4 <> 0))
				OR ((T1.U_SO_P5Prc IS NULL OR T1.U_SO_P5Prc = 0 ) AND (T1.U_SO_TP5 IS NOT NULL AND T1.U_SO_TP5 <> 0))
				OR ((T1.U_SO_P6Prc IS NULL OR T1.U_SO_P6Prc = 0 ) AND (T1.U_SO_TP6 IS NOT NULL AND T1.U_SO_TP6 <> 0))
				OR ((T1.U_SO_P7Prc IS NULL OR T1.U_SO_P7Prc = 0 ) AND (T1.U_SO_TP7 IS NOT NULL AND T1.U_SO_TP7 <> 0)))
			
			
			OR (((T1.U_SO_P1Prc IS NOT NULL AND T1.U_SO_P1Prc <> 0 ) AND (T1.U_SO_TP1 IS NULL OR T1.U_SO_TP1 = 0))
				OR ((T1.U_SO_P2Prc IS NOT NULL AND T1.U_SO_P2Prc <> 0 ) AND (T1.U_SO_TP2 IS NULL OR T1.U_SO_TP2 = 0))			
				OR ((T1.U_SO_P3Prc IS NOT NULL AND T1.U_SO_P3Prc <> 0 ) AND (T1.U_SO_TP3 IS NULL OR T1.U_SO_TP3 = 0))
				OR ((T1.U_SO_P4Prc IS NOT NULL AND T1.U_SO_P4Prc <> 0 ) AND (T1.U_SO_TP4 IS NULL OR T1.U_SO_TP4 = 0))
				OR ((T1.U_SO_P5Prc IS NOT NULL AND T1.U_SO_P5Prc <> 0 ) AND (T1.U_SO_TP5 IS NULL OR T1.U_SO_TP5 = 0))
				OR ((T1.U_SO_P6Prc IS NOT NULL AND T1.U_SO_P6Prc <> 0 ) AND (T1.U_SO_TP6 IS NULL OR T1.U_SO_TP6 = 0))
				OR ((T1.U_SO_P7Prc IS NOT NULL AND T1.U_SO_P7Prc <> 0 ) AND (T1.U_SO_TP7 IS NULL OR T1.U_SO_TP7 = 0)))


--			(T1.U_SO_PrcM2 IS NULL OR T1.U_SO_PrcM2 = 0) --OR 
--			(T1.U_SO_TRM IS NULL OR T1.U_SO_TRM = 0)
			)
		IF @countRecord = 1			
		BEGIN
			IF @WhsCode = 'FG-001' AND @ItemCode Like 'CS%'
			BEGIN
				If @Quantity = 0 OR @Quantity IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Quantity!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

--				ELSE If @Price = 0 OR @Price IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Unit Price!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
--				END
	
				ELSE If @KodeJenisKaca = '' OR @KodeJenisKaca IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT KODE JENIS KACA TEBAL!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE If @JenisKaca = '' OR @JenisKaca IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT JENIS KACA !!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END				
				
				ELSE If @Tebal = 0 OR @Tebal IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT TEBAL!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END

				ELSE If @Warna = '' OR @Warna IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT WARNA!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE If @Keterangan = '' OR @Keterangan IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT KETERANGAN!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 	
				END
			
				ELSE If @LUASM2 = 0 OR @LUASM2 IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Luas M2!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END	

--				ELSE If @PriceM2 = 0 OR @PriceM2 IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Price M2!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@LineNum + 1)	
--				END	

--				ELSE If @TotalRM = 0 OR @TotalRM IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Total Raw Material!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@LineNum + 1)	
--				END	

-- Modified karno 24 mei 2010
				ELSE IF(@TotalCalRM <> @TotalRM)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total RM (LUASM2 * PriceM2)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob01 <> @TotalJob01)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 1 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob02 <> @TotalJob02)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 2 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob03 <> @TotalJob03)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 3 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob04 <> @TotalJob04)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 4 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob05 <> @TotalJob05)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 5 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob06 <> @TotalJob06)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 6 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob07 <> @TotalJob07)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 7 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

-- Jika Kode Job diisi dan job Qty tidak diisi maka Job Qty wajib isi 

				ELSE IF((@Job01 <> '' AND @Job01 IS NOT NULL  ) AND (@JobQty01 IS NULL OR @JobQty01 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 01 DIISI, MAKA JOB QTY 01 HARUS DIISI !!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job02 <> ''  AND @Job02 IS NOT NULL ) AND (@JobQty02 IS NULL OR @JobQty02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 02 DIISI, MAKA JOB QTY 02 HARUS DIISI !!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job03 IS NOT NULL AND @Job03 <> '') AND (@JobQty03 IS NULL OR @JobQty03 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 03 DIISI, MAKA JOB QTY 03 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job04 IS NOT NULL AND @Job04 <> '') AND (@JobQty04 IS NULL OR @JobQty04 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 04 DIISI, MAKA JOB QTY 04 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job05 IS NOT NULL AND @Job05 <> '') AND (@JobQty05 IS NULL OR @JobQty05 = 0)) 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 05 DIISI, MAKA JOB QTY 05 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job06 IS NOT NULL AND @Job06 <> '') AND (@JobQty06 IS NULL OR @JobQty06 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 06 DIISI, MAKA JOB QTY 06 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job07 IS NOT NULL AND @Job07 <> '') AND (@JobQty07 IS NULL OR @JobQty07 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 07 DIISI, MAKA JOB QTY 07 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

-- Jika Job Qty diisi dan job01 tidak diisi maka Job01 wajib isi 
				ELSE IF((@Job01 IS NULL OR @Job01 = '') AND (@JobQty01 IS NOT NULL AND @JobQty01 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 01 DIISI, MAKA JOB 01 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END		
				ELSE IF((@Job02 IS NULL OR @Job02 = '') AND (@JobQty02 IS NOT NULL AND @JobQty02 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 02 DIISI, MAKA JOB 02 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job03 IS NULL OR @Job03 = '') AND (@JobQty03 IS NOT NULL AND @JobQty03 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 03 DIISI, MAKA JOB 03 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job04 IS NULL OR @Job04 = '') AND (@JobQty04 IS NOT NULL AND @JobQty04 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 04 DIISI, MAKA JOB 04 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job05 IS NULL OR @Job05 = '') AND (@JobQty05 IS NOT NULL AND @JobQty05 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 05 DIISI, MAKA JOB 05 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job06 IS NULL OR @Job06 = '') AND (@JobQty06 IS NOT NULL AND @JobQty06 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 06 DIISI, MAKA JOB 06 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job07 IS NULL OR @Job07 = '') AND (@JobQty07 IS NOT NULL AND @JobQty07 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 07 DIISI, MAKA JOB 07 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END		

-- Jika Total Job diisi dan job RP tidak diisi maka Job RP wajib isi 

				ELSE IF((@JobRP01 = 0 OR @JobRP01 IS NULL  ) AND (@TotalJob01 IS NOT NULL AND @TotalJob01 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 01 DIISI, MAKA JOB RP 01 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 
				END
				ELSE IF((@JobRP02 = 0 OR @JobRP02 IS NULL  ) AND (@TotalJob02 IS NOT NULL AND @TotalJob02 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 02 DIISI, MAKA JOB RP 02 HARUS DIISI !!!'  + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP03 = 0 OR @JobRP03 IS NULL  ) AND (@TotalJob03 IS NOT NULL AND @TotalJob03 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 03 DIISI, MAKA JOB RP 03 HARUS DIISI !!!'  + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP04 = 0 OR @JobRP04 IS NULL  ) AND (@TotalJob04 IS NOT NULL AND @TotalJob04 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 04 DIISI, MAKA JOB RP 04 HARUS DIISI !!!'  + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP05 = 0 OR @JobRP05 IS NULL  ) AND (@TotalJob05 IS NOT NULL AND @TotalJob05 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 05 DIISI, MAKA JOB RP 05 HARUS DIISI !!!'  + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP06 = 0 OR @JobRP06 IS NULL  ) AND (@TotalJob06 IS NOT NULL AND @TotalJob06 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 06 DIISI, MAKA JOB RP 06 HARUS DIISI !!!'  + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP07 = 0 OR @JobRP07 IS NULL  ) AND (@TotalJob07 IS NOT NULL AND @TotalJob07 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 07 DIISI, MAKA JOB RP 07 HARUS DIISI !!!'  + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

-- Jika Job RP diisi dan Total job tidak diisi maka Job RP wajib isi 

				ELSE IF((@JobRP01 <> 0 AND @JobRP01 IS NOT NULL  ) AND (@TotalJob01 IS NULL OR @TotalJob01 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 01 DIISI, MAKA TOTAL JOB 01 HARUS DIISI !!!'  + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP02 <> 0 AND @JobRP02 IS NOT NULL  ) AND (@TotalJob02 IS NULL OR @TotalJob02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 02 DIISI, MAKA TOTAL JOB 02 HARUS DIISI !!!'  + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP03 <> 0 AND @JobRP03 IS NOT NULL  ) AND (@TotalJob03 IS NULL OR @TotalJob02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 03 DIISI, MAKA TOTAL JOB 03 HARUS DIISI !!!'  + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP04 <> 0 AND @JobRP04 IS NOT NULL  ) AND (@TotalJob04 IS NULL OR @TotalJob04 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 04 DIISI, MAKA TOTAL JOB 04 HARUS DIISI !!!'  + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@JobRP05 <> 0 AND @JobRP05 IS NOT NULL  ) AND (@TotalJob05 IS NULL OR @TotalJob05 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 05 DIISI, MAKA TOTAL JOB 05 HARUS DIISI !!!'  + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP06 <> 0 AND @JobRP06 IS NOT NULL  ) AND (@TotalJob06 IS NULL OR @TotalJob06 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 06 DIISI, MAKA TOTAL JOB 06 HARUS DIISI !!!'  + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP07 <> 0 AND @JobRP07 IS NOT NULL  ) AND (@TotalJob07 IS NULL OR @TotalJob07 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 07 DIISI, MAKA TOTAL JOB 07 HARUS DIISI !!!'  + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
			END --Warehouse
		END -- CountRecord
-----------------------------------------------------------------------------------------------------
----  AKHIR --- JIKA Warehouse FG-001 Dengan kondisi Penjualan Kaca Dan ItemCode Diawali dengan CS ---
-----------------------------------------------------------------------------------------------------
--
-----------------------------------------------------------------------------------------------------
----  AWAL --- JIKA Warehouse FG-002 Dengan kondisi JASA ---
-----------------------------------------------------------------------------------------------------
--else IF @WhsCode = 'FG-002'
--BEGIN
SET @countRecord = 0
		select TOP 1
		@VisOrder = VisOrder,
		@LineNum = LineNum,
		@WhsCode = WhsCode,
		@ItemCode = ItemCode,
		@KodeJenisKaca = U_MIS_JNSKACATEB,
		@JenisKaca = U_MIS_JenisKaca,
		@Tebal = U_MIS_Tebal,
		@Warna = U_MIS_Warna,
		@Keterangan = U_MIS_Desc,		
		@Quantity = Quantity,
		@Price = Price,		
		@LUASM2 = U_SO_LUASM2,
		@PriceM2 = U_SO_PrcM2,
		@TotalRM = ROUND(U_SO_TRM,2),
		@TotalCalRM = ROUND(ROUND(U_SO_LUASM2,4) * ROUND(U_SO_PrcM2,4),2),
-- jika total Job tidak sama dengan Qty * Price
		@TotalCalJob01 = ROUND(ROUND(U_SO_QP1,4) * ROUND(U_SO_P1Prc,4),4),
		@TotalCalJob02 = ROUND(ROUND(U_SO_QP2,4) * ROUND(U_SO_P2Prc,4),4),
		@TotalCalJob03 = ROUND(ROUND(U_SO_QP3,4) * ROUND(U_SO_P3Prc,4),4),
		@TotalCalJob04 = ROUND(ROUND(U_SO_QP4,4) * ROUND(U_SO_P4Prc,4),4),
		@TotalCalJob05 = ROUND(ROUND(U_SO_QP5,4) * ROUND(U_SO_P5Prc,4),4),
		@TotalCalJob06 = ROUND(ROUND(U_SO_QP6,4) * ROUND(U_SO_P6Prc,4),4),
		@TotalCalJob07 = ROUND(ROUND(U_SO_QP7,4) * ROUND(U_SO_P7Prc,4),4),		
		@Job01 = U_SO_P1, @JobQty01 = U_SO_QP1, @JobRp01 = U_SO_P1Prc, @TotalJob01 = ROUND(U_SO_TP1,4),
		@Job02 = U_SO_P2, @JobQty02 = U_SO_QP2, @JobRp02 = U_SO_P2Prc, @TotalJob02 = ROUND(U_SO_TP2,4),
		@Job03 = U_SO_P3, @JobQty03 = U_SO_QP3, @JobRp03 = U_SO_P3Prc, @TotalJob03 = ROUND(U_SO_TP3,4),
		@Job04 = U_SO_P4, @JobQty04 = U_SO_QP4, @JobRp04 = U_SO_P4Prc, @TotalJob04 = ROUND(U_SO_TP4,4),
		@Job05 = U_SO_P5, @JobQty05 = U_SO_QP5, @JobRp05 = U_SO_P5Prc, @TotalJob05 = ROUND(U_SO_TP5,4),
		@Job06 = U_SO_P6, @JobQty06 = U_SO_QP6, @JobRp06 = U_SO_P6Prc, @TotalJob06 = ROUND(U_SO_TP6,4),
		@Job07 = U_SO_P7, @JobQty07 = U_SO_QP7, @JobRp07 = U_SO_P7Prc, @TotalJob07 = ROUND(U_SO_TP7,4),
		@countRecord = 1
		FROM RDR1 T1
		JOIN ORDR T0
		ON T1.DOCENTRY = T0.DOCENTRY
		WHERE T1.DOCENTRY = CAST(@list_of_cols_val_tab_del AS INT)
			AND DOCTYPE = 'I'
			AND WhsCode = 'FG-002' 
			AND 
			(	
			(T1.Quantity IS NULL OR T1.Quantity = 0) OR			
--			(T1.Price IS NULL OR T1.Price = 0) OR
			(T1.U_MIS_JNSKACATEB IS NOT NULL AND T1.U_MIS_JNSKACATEB <> '') OR
			(T1.U_MIS_JenisKaca IS NOT NULL AND T1.U_MIS_JenisKaca <> '') OR
			(T1.U_MIS_Tebal IS NOT NULL AND T1.U_MIS_Tebal <> 0) OR
			(T1.U_MIS_Warna IS NOT NULL AND T1.U_MIS_Warna <> '') OR
			(T1.U_MIS_Desc IS NOT NULL AND T1.U_MIS_Desc <> '') OR			
--			(T1.U_SO_LUASM2 IS NULL OR T1.U_SO_LUASM2 = 0) OR
			(T1.U_SO_PrcM2 IS NOT NULL AND T1.U_SO_PrcM2 <> 0) OR
			(T1.U_SO_TRM IS NOT NULL AND T1.U_SO_TRM <> 0)
			OR (ROUND(T1.U_SO_TRM,2) <> Round(Round(U_SO_LUASM2,4) * round(U_SO_PrcM2,4),2))

			OR (ROUND(U_SO_TP1,4) <> Round(ROUND(U_SO_QP1,4) * ROUND(U_SO_P1Prc,4),4))
			OR (ROUND(U_SO_TP2,4) <> Round(ROUND(U_SO_QP2,4) * ROUND(U_SO_P2Prc,4),4))
			OR (ROUND(U_SO_TP3,4) <> Round(ROUND(U_SO_QP3,4) * ROUND(U_SO_P3Prc,4),4))
			OR (ROUND(U_SO_TP4,4) <> Round(ROUND(U_SO_QP4,4) * ROUND(U_SO_P4Prc,4),4))
			OR (ROUND(U_SO_TP5,4) <> Round(ROUND(U_SO_QP5,4) * ROUND(U_SO_P5Prc,4),4))
			OR (ROUND(U_SO_TP6,4) <> Round(ROUND(U_SO_QP6,4) * ROUND(U_SO_P6Prc,4),4))
			OR (ROUND(U_SO_TP7,4) <> Round(ROUND(U_SO_QP7,4) * ROUND(U_SO_P7Prc,4),4))
			OR ((T1.U_SO_P1 IS NULL OR T1.U_SO_P1 = '') 
				AND (T1.U_SO_P2 IS NULL OR T1.U_SO_P2 = '')
				AND (T1.U_SO_P3 IS NULL OR T1.U_SO_P3 = '') 
				AND (T1.U_SO_P4 IS NULL OR T1.U_SO_P4 = '') 
				AND (T1.U_SO_P5 IS NULL OR T1.U_SO_P5 = '') 
				AND (T1.U_SO_P6 IS NULL OR T1.U_SO_P6 = '') 
				AND (T1.U_SO_P7 IS NULL OR T1.U_SO_P7 = ''))
			OR (((T1.U_SO_QP1 IS NULL OR T1.U_SO_QP1 = 0 ) AND (T1.U_SO_P1 IS NOT NULL AND T1.U_SO_P1 <> ''))
				OR ((T1.U_SO_QP2 IS NULL OR T1.U_SO_QP2 = 0 ) AND (T1.U_SO_P2 IS NOT NULL AND T1.U_SO_P2 <> ''))			
				OR ((T1.U_SO_QP3 IS NULL OR T1.U_SO_QP3 = 0 ) AND (T1.U_SO_P3 IS NOT NULL AND T1.U_SO_P3 <> ''))
				OR ((T1.U_SO_QP4 IS NULL OR T1.U_SO_QP4 = 0 ) AND (T1.U_SO_P4 IS NOT NULL AND T1.U_SO_P4 <> ''))
				OR ((T1.U_SO_QP5 IS NULL OR T1.U_SO_QP5 = 0 ) AND (T1.U_SO_P5 IS NOT NULL AND T1.U_SO_P5 <> ''))
				OR ((T1.U_SO_QP6 IS NULL OR T1.U_SO_QP6 = 0 ) AND (T1.U_SO_P6 IS NOT NULL AND T1.U_SO_P6 <> ''))
				OR ((T1.U_SO_QP7 IS NULL OR T1.U_SO_QP7 = 0 ) AND (T1.U_SO_P7 IS NOT NULL AND T1.U_SO_P7 <> '')))
			OR (((T1.U_SO_QP1 IS NOT NULL AND T1.U_SO_QP1 <> 0 ) AND (T1.U_SO_P1 IS NULL OR T1.U_SO_P1 = ''))
				OR ((T1.U_SO_QP2 IS NOT NULL AND T1.U_SO_QP2 <> 0 ) AND (T1.U_SO_P2 IS NULL OR T1.U_SO_P2 = ''))			
				OR ((T1.U_SO_QP3 IS NOT NULL AND T1.U_SO_QP3 <> 0 ) AND (T1.U_SO_P3 IS NULL OR T1.U_SO_P3 = ''))
				OR ((T1.U_SO_QP4 IS NOT NULL AND T1.U_SO_QP4 <> 0 ) AND (T1.U_SO_P4 IS NULL OR T1.U_SO_P4 = ''))
				OR ((T1.U_SO_QP5 IS NOT NULL AND T1.U_SO_QP5 <> 0 ) AND (T1.U_SO_P5 IS NULL OR T1.U_SO_P5 = ''))
				OR ((T1.U_SO_QP6 IS NOT NULL AND T1.U_SO_QP6 <> 0 ) AND (T1.U_SO_P6 IS NULL OR T1.U_SO_P6 = ''))
				OR ((T1.U_SO_QP7 IS NOT NULL AND T1.U_SO_QP7 <> 0 ) AND (T1.U_SO_P7 IS NULL OR T1.U_SO_P7 = '')))	
	
			OR (((T1.U_SO_P1Prc IS NULL OR T1.U_SO_P1Prc = 0 ) AND (T1.U_SO_TP1 IS NOT NULL AND T1.U_SO_TP1 <> 0))
				OR ((T1.U_SO_P2Prc IS NULL OR T1.U_SO_P2Prc = 0 ) AND (T1.U_SO_TP2 IS NOT NULL AND T1.U_SO_TP2 <> 0))			
				OR ((T1.U_SO_P3Prc IS NULL OR T1.U_SO_P3Prc = 0 ) AND (T1.U_SO_TP3 IS NOT NULL AND T1.U_SO_TP3 <> 0))
				OR ((T1.U_SO_P4Prc IS NULL OR T1.U_SO_P4Prc = 0 ) AND (T1.U_SO_TP4 IS NOT NULL AND T1.U_SO_TP4 <> 0))
				OR ((T1.U_SO_P5Prc IS NULL OR T1.U_SO_P5Prc = 0 ) AND (T1.U_SO_TP5 IS NOT NULL AND T1.U_SO_TP5 <> 0))
				OR ((T1.U_SO_P6Prc IS NULL OR T1.U_SO_P6Prc = 0 ) AND (T1.U_SO_TP6 IS NOT NULL AND T1.U_SO_TP6 <> 0))
				OR ((T1.U_SO_P7Prc IS NULL OR T1.U_SO_P7Prc = 0 ) AND (T1.U_SO_TP7 IS NOT NULL AND T1.U_SO_TP7 <> 0)))
			
			OR (((T1.U_SO_P1Prc IS NOT NULL AND T1.U_SO_P1Prc <> 0 ) AND (T1.U_SO_TP1 IS NULL OR T1.U_SO_TP1 = 0))
				OR ((T1.U_SO_P2Prc IS NOT NULL AND T1.U_SO_P2Prc <> 0 ) AND (T1.U_SO_TP2 IS NULL OR T1.U_SO_TP2 = 0))			
				OR ((T1.U_SO_P3Prc IS NOT NULL AND T1.U_SO_P3Prc <> 0 ) AND (T1.U_SO_TP3 IS NULL OR T1.U_SO_TP3 = 0))
				OR ((T1.U_SO_P4Prc IS NOT NULL AND T1.U_SO_P4Prc <> 0 ) AND (T1.U_SO_TP4 IS NULL OR T1.U_SO_TP4 = 0))
				OR ((T1.U_SO_P5Prc IS NOT NULL AND T1.U_SO_P5Prc <> 0 ) AND (T1.U_SO_TP5 IS NULL OR T1.U_SO_TP5 = 0))
				OR ((T1.U_SO_P6Prc IS NOT NULL AND T1.U_SO_P6Prc <> 0 ) AND (T1.U_SO_TP6 IS NULL OR T1.U_SO_TP6 = 0))
				OR ((T1.U_SO_P7Prc IS NOT NULL AND T1.U_SO_P7Prc <> 0 ) AND (T1.U_SO_TP7 IS NULL OR T1.U_SO_TP7 = 0)))
			)

		IF @countRecord = 1			
		BEGIN
			IF @WhsCode = 'FG-002' 
			BEGIN
				If @Quantity = 0 OR @Quantity IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Quantity!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

--				ELSE If @Price = 0 OR @Price IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Unit Price!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
--				END
-- Jika Kode Jenis Kaca Diisi	
				ELSE If @KodeJenisKaca <> '' AND @KodeJenisKaca IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JENIS KACA TEBAL TIDAK BOLEH DIISI!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
-- Jika Jenis Kaca Diisi
				ELSE If @JenisKaca <> '' AND @JenisKaca IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JENIS KACA TIDAK BOLEH DIISI!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END				
-- Jika Tebal Diisi				
				ELSE If @Tebal <> 0 AND @Tebal IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? TEBAL TIDAK BOLEH DIISI!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END
-- Jika Warna Diisi
				ELSE If @Warna <> '' AND @Warna IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? WARNA TIDAK BOLEH DIISI!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
-- Jika Keterangan Diisi
				ELSE If @Keterangan <> '' AND @Keterangan IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? KETERANGAN TIDAK BOLEH DIISI!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	 	
				END

--				ELSE If @LUASM2 = 0 OR @LUASM2 IS NULL 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Luas M2!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
--				END	

				ELSE If @PriceM2 <> 0 AND @PriceM2 IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PriceM2 Tidak Boleh Diisi!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END

				ELSE If @TotalRM <> 0 AND @TotalRM IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Total RM Tidak Boleh Diisi!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END
-- Jika Job 01 sampai Job 07 tidak diisi maka eror
				ELSE If ((@Job01 IS NULL OR @Job01 = '') 
				AND (@Job02 IS NULL OR @Job02 = '')
				AND (@Job03 IS NULL OR @Job03 = '') 
				AND (@Job04 IS NULL OR @Job04 = '') 
				AND (@Job05 IS NULL OR @Job05 = '') 
				AND (@Job06 IS NULL OR @Job06 = '') 
				AND (@Job07 IS NULL OR @Job07 = ''))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT JOB !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

-- Modified karno 24 mei 2010
				ELSE IF(@TotalCalRM <> @TotalRM)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total RM (LUASM2 * PriceM2)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob01 <> @TotalJob01)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 1 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob02 <> @TotalJob02)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 2 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob03 <> @TotalJob03)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 3 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob04 <> @TotalJob04)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 4 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob05 <> @TotalJob05)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 5 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob06 <> @TotalJob06)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 6 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF(@TotalCalJob07 <> @TotalJob07)
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Check Total Job 7 (Qty Job* Rp Job)!!!' + @object_type + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

-- Jika Kode Job diisi dan job Qty tidak diisi maka Job Qty wajib isi 

				ELSE IF((@Job01 <> '' AND @Job01 IS NOT NULL  ) AND (@JobQty01 IS NULL OR @JobQty01 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 01 DIISI, MAKA JOB QTY 01 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job02 <> ''  AND @Job02 IS NOT NULL ) AND (@JobQty02 IS NULL OR @JobQty02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 02 DIISI, MAKA JOB QTY 02 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job03 IS NOT NULL AND @Job03 <> '') AND (@JobQty03 IS NULL OR @JobQty03 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 03 DIISI, MAKA JOB QTY 03 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE IF((@Job04 IS NOT NULL AND @Job04 <> '') AND (@JobQty04 IS NULL OR @JobQty04 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 04 DIISI, MAKA JOB QTY 04 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job05 IS NOT NULL AND @Job05 <> '') AND (@JobQty05 IS NULL OR @JobQty05 = 0)) 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 05 DIISI, MAKA JOB QTY 05 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job06 IS NOT NULL AND @Job06 <> '') AND (@JobQty06 IS NULL OR @JobQty06 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 06 DIISI, MAKA JOB QTY 06 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@Job07 IS NOT NULL AND @Job07 <> '') AND (@JobQty07 IS NULL OR @JobQty07 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB 07 DIISI, MAKA JOB QTY 07 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

-- Jika Job Qty diisi dan job01 tidak diisi maka Job01 wajib isi 
				ELSE IF((@Job01 IS NULL OR @Job01 = '') AND (@JobQty01 IS NOT NULL AND @JobQty01 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 01 DIISI, MAKA JOB 01 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END		
				ELSE IF((@Job02 IS NULL OR @Job02 = '') AND (@JobQty02 IS NOT NULL AND @JobQty02 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 02 DIISI, MAKA JOB 02 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job03 IS NULL OR @Job03 = '') AND (@JobQty03 IS NOT NULL AND @JobQty03 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 03 DIISI, MAKA JOB 03 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job04 IS NULL OR @Job04 = '') AND (@JobQty04 IS NOT NULL AND @JobQty04 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 04 DIISI, MAKA JOB 04 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job05 IS NULL OR @Job05 = '') AND (@JobQty05 IS NOT NULL AND @JobQty05 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 05 DIISI, MAKA JOB 05 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job06 IS NULL OR @Job06 = '') AND (@JobQty06 IS NOT NULL AND @JobQty06 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 06 DIISI, MAKA JOB 06 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@Job07 IS NULL OR @Job07 = '') AND (@JobQty07 IS NOT NULL AND @JobQty07 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB Qty 07 DIISI, MAKA JOB 07 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END		

-- Jika Total Job diisi dan job RP tidak diisi maka Job RP wajib isi 

				ELSE IF((@JobRP01 = 0 OR @JobRP01 IS NULL  ) AND (@TotalJob01 IS NOT NULL AND @TotalJob01 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 01 DIISI, MAKA JOB RP 01 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP02 = 0 OR @JobRP02 IS NULL  ) AND (@TotalJob02 IS NOT NULL AND @TotalJob02 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 02 DIISI, MAKA JOB RP 02 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP03 = 0 OR @JobRP03 IS NULL  ) AND (@TotalJob03 IS NOT NULL AND @TotalJob03 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 03 DIISI, MAKA JOB RP 03 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP04 = 0 OR @JobRP04 IS NULL  ) AND (@TotalJob04 IS NOT NULL AND @TotalJob04 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 04 DIISI, MAKA JOB RP 04 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP05 = 0 OR @JobRP05 IS NULL  ) AND (@TotalJob05 IS NOT NULL AND @TotalJob05 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 05 DIISI, MAKA JOB RP 05 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP06 = 0 OR @JobRP06 IS NULL  ) AND (@TotalJob06 IS NOT NULL AND @TotalJob06 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 06 DIISI, MAKA JOB RP 06 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP07 = 0 OR @JobRP07 IS NULL  ) AND (@TotalJob07 IS NOT NULL AND @TotalJob07 <> 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA TOTAL JOB 07 DIISI, MAKA JOB RP 07 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

-- Jika Job RP diisi dan Total job tidak diisi maka Job RP wajib isi 

				ELSE IF((@JobRP01 <> 0 AND @JobRP01 IS NOT NULL  ) AND (@TotalJob01 IS NULL OR @TotalJob01 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 01 DIISI, MAKA TOTAL JOB 01 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP02 <> 0 AND @JobRP02 IS NOT NULL  ) AND (@TotalJob02 IS NULL OR @TotalJob02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 02 DIISI, MAKA TOTAL JOB 02 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP03 <> 0 AND @JobRP03 IS NOT NULL  ) AND (@TotalJob03 IS NULL OR @TotalJob02 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 03 DIISI, MAKA TOTAL JOB 03 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP04 <> 0 AND @JobRP04 IS NOT NULL  ) AND (@TotalJob04 IS NULL OR @TotalJob04 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 04 DIISI, MAKA TOTAL JOB 04 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END	
				ELSE IF((@JobRP05 <> 0 AND @JobRP05 IS NOT NULL  ) AND (@TotalJob05 IS NULL OR @TotalJob05 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 05 DIISI, MAKA TOTAL JOB 05 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP06 <> 0 AND @JobRP06 IS NOT NULL  ) AND (@TotalJob06 IS NULL OR @TotalJob06 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 06 DIISI, MAKA TOTAL JOB 06 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
				ELSE IF((@JobRP07 <> 0 AND @JobRP07 IS NOT NULL  ) AND (@TotalJob07 IS NULL OR @TotalJob07 = 0))
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? JIKA JOB RP 07 DIISI, MAKA TOTAL JOB 07 HARUS DIISI !!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END
			END -- Warehouse
		END -- Count Record

---------------------------------------------------------------------------------------------------
--  AWAL --- JIKA Warehouse Bukan FG-001 Dan FG-002 ---
---------------------------------------------------------------------------------------------------
--else IF @WhsCode <> 'FG-001' AND @WhsCode <> 'FG-002'
--BEGIN
SET @countRecord = 0
		select TOP 1
		@LineNum = LineNum,
		@WhsCode = WhsCode,
		@ItemCode = ItemCode,
		@Quantity = Quantity,
		@Price = Price,
		@PriceM2 = U_SO_PrcM2,
		@TotalRM = U_SO_TRM,
		@countRecord = 1
		FROM RDR1 T1
		JOIN ORDR T0
		ON T1.DOCENTRY = T0.DOCENTRY
		WHERE T1.DOCENTRY = CAST(@list_of_cols_val_tab_del AS INT)
			AND DOCTYPE = 'I'
			AND WhsCode <> 'FG-001' AND WhsCode <> 'FG-002'
			AND 
			(	
			(T1.Quantity IS NULL OR T1.Quantity = 0) OR			
			(T1.Price IS NULL OR T1.Price = 0) OR
			(T1.U_SO_PrcM2 IS NOT NULL AND T1.U_SO_PrcM2 <> 0) OR
			(T1.U_SO_TRM IS NOT NULL AND T1.U_SO_TRM <> 0)
			)
		IF @countRecord = 1			
		BEGIN
			IF @WhsCode <> 'FG-001' AND @WhsCode <> 'FG-002'
			BEGIN
				If @Quantity = 0 OR @Quantity IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Quantity!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE If @Price = 0 OR @Price IS NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PLEASE INPUT Unit Price!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)	
				END

				ELSE If @PriceM2 <> 0 AND @PriceM2 IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? PriceM2 Tidak Boleh Diisi!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END

				ELSE If @TotalRM <> 0 AND @TotalRM IS NOT NULL 
				BEGIN
					SELECT @error = 1, 
						@error_message = 'NOT SUCESSFULLY??? Total RM Tidak Boleh Diisi!!!' + @object_type + ', DocEntry = '  + @list_of_cols_val_tab_del + ' Baris Ke : ' + CONVERT(NVARCHAR(3),@VisOrder + 1)		
				END
	
			END --Warehouse
		END -- CountRecord
-----------------------------------------------------------------------------------------------------
----  AKHIR --- JIKA Warehouse BUKAN FG-001 DAN FG-002 ---
-----------------------------------------------------------------------------------------------------
END -- Object Type

-- Incoming Payment Object
IF @transaction_type = 'A' AND @Object_type = '24'

BEGIN

DECLARE @INCOMINGPAYMENT_LINENUM INT,
		@INCOMINGPAYMENT_InvoiceDocNum INT, 
		@INCOMINGPAYMENT_InvoiceAmountInGiro NUMERIC(19, 6),
		@INCOMINGPAYMENT_TotalPayment NUMERIC(19, 6)

IF EXISTS 
(--SELECT T0.DOCENTRY FROM dbo.ORCT T0 WHERE T0.DOCENTRY = @list_of_cols_val_tab_del
SELECT TOP 1 T0.DocNum
----T0.DocNum, T4.U_OINVDocNum, 
--@INCOMINGPAYMENT_LINENUM = T1.InvoiceId + 1,  --LineNum
--@INCOMINGPAYMENT_InvoiceDocNum = T2.DocNum,
--@INCOMINGPAYMENT_InvoiceAmountInGiro = T4.U_CollectAmount,
--@INCOMINGPAYMENT_TotalPayment = T1.SumApplied
----T0.TrsfrSum, SumApplied, T4.U_CollectAmount 
FROM ORCT T0
JOIN RCT2 T1 ON T1.DocNum = T0.DocNum
JOIN OINV T2 ON T2.DocEntry = T1.DocEntry
JOIN [@MIS_PDC] T3 ON T3.U_PDCBankID = T0.U_PDCBankID AND T3.U_PDCNo = T0.U_PDCNo 
JOIN [@MIS_PDCL] T4 ON T4.DocEntry = T3.DocEntry AND T4.U_OINVDocNum = T2.DocNum 
WHERE T0.DocNum = @list_of_cols_val_tab_del -- 111100002 -- 
AND T4.U_CollectAmount <> T1.SumApplied
)
BEGIN

SELECT TOP 1
--T0.DocNum, T4.U_OINVDocNum, 
@INCOMINGPAYMENT_LINENUM = T1.InvoiceId + 1,  --LineNum
@INCOMINGPAYMENT_InvoiceDocNum = T2.DocNum,
@INCOMINGPAYMENT_InvoiceAmountInGiro = T4.U_CollectAmount,
@INCOMINGPAYMENT_TotalPayment = T1.SumApplied
--T0.TrsfrSum, SumApplied, T4.U_CollectAmount 
FROM ORCT T0
JOIN RCT2 T1 ON T1.DocNum = T0.DocNum
JOIN OINV T2 ON T2.DocEntry = T1.DocEntry
JOIN [@MIS_PDC] T3 ON T3.U_PDCBankID = T0.U_PDCBankID AND T3.U_PDCNo = T0.U_PDCNo 
JOIN [@MIS_PDCL] T4 ON T4.DocEntry = T3.DocEntry AND T4.U_OINVDocNum = T2.DocNum 
WHERE T0.DocNum = @list_of_cols_val_tab_del -- 111100002 -- 
AND T4.U_CollectAmount <> T1.SumApplied
ORDER BY T1.InvoiceId 

SELECT @error = 1, 
	@error_message = 'NOT SUCESSFULLY???  Total Payment Amount Harus Sama antara Giro dan Incoming Payment, Pada Line: ' 
	+ CONVERT(VARCHAR(10),@INCOMINGPAYMENT_LINENUM)
	+ ' Invoice#: ' + CONVERT(NVARCHAR, @INCOMINGPAYMENT_InvoiceDocNum)
	+ ' Giro inv Amt: ' + CONVERT(NVARCHAR, @INCOMINGPAYMENT_InvoiceAmountInGiro)
	+ ' Total Payment Amt: ' + CONVERT(NVARCHAR, @INCOMINGPAYMENT_TotalPayment)
	
END

END -- End of Incoming Payment
-- Incoming Payment Object


Jump_EndNotif:

-- 20100423 by Toin
-- Select the return values
select @error, @error_message

END -- Akhir



-- BLOCKING DELIVERY
--	IF  (@object_type = N'15')
--	AND (@transaction_type = 'A' OR @transaction_type = 'U')
--	BEGIN 

--	SELECT TOP 1 @WhsCode = T0.WhsCode,
--	@Price = T0.Price, @JenisKaca = U_MIS_JenisKaca, @TotalRM = U_SO_TRM
--	FROM DLN1 T0
--	WHERE T0.DOCENTRY =  CAST(@list_of_cols_val_tab_del AS INT)
--
----			IF @WhsCode = 'aaa'
----			BEGIN
--				If @WhsCode = 'FG-001'
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = CONVERT(VARCHAR(30),@Price) + @JenisKaca + CONVERT(VARCHAR(30),@TotalRM)
--				END
----			END



--SELECT @BaseType = BaseType FROM DLN1 
--WHERE DOCENTRY = CAST(@list_of_cols_val_tab_del AS INT)
--
---- Jika Form DO Tidak Berdasarkan SO maka DO dapat diinput
--IF @BaseType = -1 
--BEGIN
--	SELECT @error	
--END
---- Jika Form DO Berdasarkan pada SO Maka Akan melakukan pencegahan dimana Price harus sama dengan Total RM + TotalJob 1 hingga Total Job7
--ELSE
--BEGIN
--	SELECT @DocNum = T1.DocNum, @WhsCode = T2.WhsCode,
--	@Price = T2.Price,
--	@TotalALLRM = (T2.U_SO_TRM + T2.U_SO_TP1 + T2.U_SO_TP2 + T2.U_SO_TP3 + T2.U_SO_TP4 + T2.U_SO_TP5 + T2.U_SO_TP6 + T2.U_SO_TP7)
--	FROM DLN1 T0
--	INNER JOIN ORDR T1
--	ON T0.BaseEntry = T1.DocEntry
--	AND T0.BaseRef = T1.DocNum
--	INNER JOIN RDR1 T2
--	ON T1.DOCENTRY = T2.DOCENTRY
--	AND T0.BaseLine = T2.LineNum
--	WHERE
--	T0.DOCENTRY =  CAST(@list_of_cols_val_tab_del AS INT)
--	AND T2.WhsCode = 'FG-001'
--	AND T2.PRICE <> (T2.U_SO_TRM + T2.U_SO_TP1 + T2.U_SO_TP2 + T2.U_SO_TP3 + T2.U_SO_TP4 + T2.U_SO_TP5 + T2.U_SO_TP6 + T2.U_SO_TP7)
--	
--			IF @WhsCode = 'FG-001'
--			BEGIN
--				If @Price <> @TotalALLRM 
--				BEGIN
--					SELECT @error = 1, 
--						@error_message = 'NOT SUCESSFULLY???  Total Price Harus Sama Dengan TotalRM + TotalJob1 SAMPAI TotalJob7 Pada DocNum SO : ' + CONVERT(VARCHAR(10),@DocNum)
--				END
--			END
--	END
--END


